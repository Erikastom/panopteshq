<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PanoptesHQ - AI-Powered Bug Bounty Recommendations</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 50%, #fef3c7 100%);
            min-height: 100vh;
        }
        .gradient-text {
            background: linear-gradient(135deg, #0ea5e9 0%, #8b5cf6 50%, #ec4899 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgba(14, 165, 233, 0.2);
        }
        .badge-advanced {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        .badge-intermediate {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }
        .badge-novice {
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
        }
        .slider {
            -webkit-appearance: none;
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: #e5e7eb;
            outline: none;
        }
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #0ea5e9;
            cursor: pointer;
        }
        .slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #0ea5e9;
            cursor: pointer;
            border: none;
        }
    </style>
</head>
<body class="text-gray-900">
    
    <!-- Landing Page -->
    <div id="landing-page" class="min-h-screen flex items-center justify-center px-4">
        <div class="max-w-5xl w-full text-center">
            <h1 class="text-6xl md:text-7xl font-bold mb-6">
                <span class="gradient-text">PanoptesHQ</span>
            </h1>
            <p class="text-3xl md:text-4xl text-gray-700 font-semibold mb-4">
                Stop choosing where to hunt
            </p>
            <p class="text-xl text-gray-600 mb-12 max-w-2xl mx-auto">
                Connect your bug bounty profiles and get AI-powered recommendations tailored to your skills and experience
            </p>
            
            <div class="grid md:grid-cols-3 gap-6 mb-12">
                <div class="bg-white/80 backdrop-blur-sm p-8 rounded-2xl shadow-lg border-2 border-sky-200">
                    <div class="w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-sky-400 to-sky-600 rounded-2xl flex items-center justify-center">
                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-bold mb-3 text-gray-800">Auto-Profile Sync</h3>
                    <p class="text-gray-600">Connect Immunefi & Cantina to auto-detect your skills, experience level, and expertise areas</p>
                </div>
                <div class="bg-white/80 backdrop-blur-sm p-8 rounded-2xl shadow-lg border-2 border-purple-200">
                    <div class="w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-purple-400 to-purple-600 rounded-2xl flex items-center justify-center">
                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-bold mb-3 text-gray-800">Smart Matching</h3>
                    <p class="text-gray-600">Get personalized program recommendations based on your tech stack and proven track record</p>
                </div>
                <div class="bg-white/80 backdrop-blur-sm p-8 rounded-2xl shadow-lg border-2 border-pink-200">
                    <div class="w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-pink-400 to-pink-600 rounded-2xl flex items-center justify-center">
                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-bold mb-3 text-gray-800">Maximize Earnings</h3>
                    <p class="text-gray-600">Hunt programs that match your strengths from both Immunefi and Cantina platforms</p>
                </div>
            </div>
            
            <button onclick="showProfileConnect()" class="bg-gradient-to-r from-sky-500 to-purple-600 hover:from-sky-600 hover:to-purple-700 text-white font-bold px-12 py-5 rounded-2xl text-xl transition-all transform hover:scale-105 shadow-xl">
                Connect Profiles →
            </button>
            
            <p class="text-gray-500 mt-6">Free • 2 minutes • No signup required</p>
        </div>
    </div>

    <!-- Profile Connection -->
    <div id="profile-connect" class="hidden min-h-screen py-16 px-4">
        <div class="max-w-2xl mx-auto">
            <button onclick="showLanding()" class="text-sky-600 hover:text-sky-700 font-semibold mb-6">← Back</button>
            
            <div class="bg-white/90 backdrop-blur-sm rounded-3xl shadow-2xl p-10 border-2 border-sky-100">
                <h2 class="text-4xl font-bold mb-3 gradient-text">Connect Your Profiles</h2>
                <p class="text-gray-600 mb-10">We'll analyze your activity to personalize recommendations</p>

                <div class="space-y-6">
                    <!-- Immunefi -->
                    <div>
                        <label class="block text-lg font-semibold text-gray-800 mb-3">
                            <span class="inline-flex items-center">
                                <svg class="w-6 h-6 mr-2 text-sky-600" fill="currentColor" viewBox="0 0 20 20"><path d="M10 2a8 8 0 100 16 8 8 0 000-16zm0 14a6 6 0 110-12 6 6 0 010 12z"/></svg>
                                Immunefi Username
                            </span>
                        </label>
                        <input 
                            type="text" 
                            id="immunefiUsername" 
                            class="w-full bg-white border-2 border-gray-300 rounded-xl px-6 py-4 text-gray-900 focus:outline-none focus:border-sky-500 text-lg"
                            placeholder="e.g., Haxatron"
                        >
                        <p class="text-sm text-gray-500 mt-2">Find it at: immunefi.com/profile/[username]</p>
                    </div>

                    <!-- Cantina -->
                    <div>
                        <label class="block text-lg font-semibold text-gray-800 mb-3">
                            <span class="inline-flex items-center">
                                <svg class="w-6 h-6 mr-2 text-purple-600" fill="currentColor" viewBox="0 0 20 20"><path d="M10 2a8 8 0 100 16 8 8 0 000-16zm0 14a6 6 0 110-12 6 6 0 010 12z"/></svg>
                                Cantina Username (Optional)
                            </span>
                        </label>
                        <input 
                            type="text" 
                            id="cantinaUsername" 
                            class="w-full bg-white border-2 border-gray-300 rounded-xl px-6 py-4 text-gray-900 focus:outline-none focus:border-purple-500 text-lg"
                            placeholder="e.g., Haxatron"
                        >
                        <p class="text-sm text-gray-500 mt-2">Find it at: cantina.xyz/u/[username]</p>
                    </div>
                </div>

                <div class="mt-10 p-6 bg-sky-50 rounded-xl border-2 border-sky-200">
                    <p class="text-sm text-gray-700">
                        <span class="font-semibold">Note:</span> We'll fetch your public earnings, findings, and programs to recommend the best bounties for you. No login required.
                    </p>
                </div>

                <button 
                    onclick="analyzeProfiles()" 
                    class="w-full mt-8 bg-gradient-to-r from-sky-500 to-purple-600 hover:from-sky-600 hover:to-purple-700 text-white font-bold px-8 py-5 rounded-2xl text-xl transition-all transform hover:scale-105 shadow-lg"
                >
                    Analyze My Profiles →
                </button>

                <p class="text-center text-gray-500 mt-6">or</p>

                <button 
                    onclick="showManualSkills()" 
                    class="w-full mt-4 bg-white hover:bg-gray-50 text-gray-700 font-semibold px-8 py-4 rounded-2xl text-lg border-2 border-gray-300 transition-all"
                >
                    Enter Skills Manually
                </button>
            </div>
        </div>
    </div>

    <!-- Loading State -->
    <div id="loading-state" class="hidden min-h-screen flex items-center justify-center px-4">
        <div class="text-center">
            <div class="inline-block animate-spin rounded-full h-16 w-16 border-4 border-sky-500 border-t-transparent mb-6"></div>
            <h3 class="text-2xl font-bold text-gray-800 mb-2">Analyzing Your Profiles...</h3>
            <p class="text-gray-600" id="loading-message">Fetching data from Immunefi</p>
        </div>
    </div>

    <!-- Profile Results + Recommendations -->
    <div id="results-page" class="hidden min-h-screen py-16 px-4">
        <div class="max-w-6xl mx-auto">
            <button onclick="showProfileConnect()" class="text-sky-600 hover:text-sky-700 font-semibold mb-6">← Try Different Profiles</button>
            
            <!-- Aggregated Profile Card -->
            <div id="profile-summary" class="bg-white/90 backdrop-blur-sm rounded-3xl shadow-2xl p-10 mb-10 border-2 border-sky-100">
                <!-- Will be populated by JavaScript -->
            </div>

            <!-- Recommendations -->
            <div>
                <h2 class="text-3xl font-bold mb-6 gradient-text">Your Personalized Recommendations</h2>
                <p class="text-gray-600 mb-8">Based on your skills and experience, here are the top programs for you:</p>
                
                <div id="recommendations-grid" class="grid md:grid-cols-2 gap-6">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Manual Skills Entry (Fallback) -->
    <div id="manual-skills" class="hidden min-h-screen py-16 px-4">
        <div class="max-w-4xl mx-auto">
            <button onclick="showProfileConnect()" class="text-sky-600 hover:text-sky-700 font-semibold mb-6">← Back</button>
            
            <div class="bg-white/90 backdrop-blur-sm rounded-3xl shadow-2xl p-10 border-2 border-sky-100">
                <h2 class="text-4xl font-bold mb-3 gradient-text">Tell Us Your Skills</h2>
                <p class="text-gray-600 mb-10">Rate your proficiency in each language and select your expertise areas</p>

                <!-- Languages with Proficiency Levels -->
                <div class="mb-10">
                    <h3 class="text-2xl font-bold mb-6 text-gray-800">Language Proficiency</h3>
                    <p class="text-sm text-gray-600 mb-6">Rate your confidence: 1 = Novice, 5 = Expert</p>
                    <div class="space-y-6" id="manual-languages">
                        <!-- Will be populated -->
                    </div>
                </div>

                <!-- Product Categories -->
                <div class="mb-10">
                    <h3 class="text-2xl font-bold mb-6 text-gray-800">Product Expertise</h3>
                    <p class="text-sm text-gray-600 mb-6">Select all categories you're familiar with</p>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-3" id="manual-categories">
                        <!-- Will be populated -->
                    </div>
                </div>

                <!-- Experience Level -->
                <div class="mb-10">
                    <h3 class="text-2xl font-bold mb-6 text-gray-800">Experience Level</h3>
                    <div class="space-y-3" id="manual-experience">
                        <!-- Will be populated -->
                    </div>
                </div>

                <button 
                    onclick="generateManualRecommendations()" 
                    class="w-full bg-gradient-to-r from-sky-500 to-purple-600 hover:from-sky-600 hover:to-purple-700 text-white font-bold px-8 py-5 rounded-2xl text-xl transition-all transform hover:scale-105 shadow-lg"
                >
                    Get Recommendations →
                </button>
            </div>
        </div>
    </div>

    <script>
        // Program Database - UPDATED WITH CORRECT CANTINA LINKS
        const PROGRAMS = [
            // Immunefi Programs
            {
                platform: "Immunefi",
                name: "GMX",
                description: "Decentralized spot and perpetual exchange with low swap fees and zero price impact trades.",
                maxBounty: "$5,000,000",
                languages: ["Solidity", "JavaScript", "TypeScript"],
                categories: ["AMM", "DEX", "Perpetuals"],
                difficulty: "Advanced",
                url: "https://immunefi.com/bug-bounty/gmx/"
            },
            {
                platform: "Immunefi",
                name: "Olympus",
                maxBounty: "$3,333,333",
                languages: ["Solidity"],
                categories: ["DAO"],
                difficulty: "Advanced",
                url: "https://immunefi.com/bug-bounty/olympus/"
            },
            {
                platform: "Immunefi",
                name: "Alchemix",
                maxBounty: "$300,000",
                languages: ["Solidity"],
                categories: ["DAO", "Synthetic Assets", "Lending"],
                difficulty: "Intermediate",
                url: "https://immunefi.com/bug-bounty/alchemix/"
            },
            {
                platform: "Immunefi",
                name: "Yearn Finance",
                maxBounty: "$200,000",
                languages: ["Solidity"],
                categories: ["Lending", "Yield Aggregator"],
                difficulty: "Intermediate",
                url: "https://immunefi.com/bug-bounty/yearn/"
            },
            {
                platform: "Immunefi",
                name: "Tranchess",
                maxBounty: "$200,000",
                languages: ["Solidity", "JavaScript"],
                categories: ["Asset Management", "Yield Aggregator"],
                difficulty: "Intermediate",
                url: "https://immunefi.com/bug-bounty/tranchess/"
            },
            {
                platform: "Immunefi",
                name: "monero-oxide",
                maxBounty: "$100,000",
                languages: ["Rust"],
                categories: ["L1"],
                difficulty: "Advanced",
                url: "https://immunefi.com/bug-bounty/monero-oxide/"
            },
            {
                platform: "Immunefi",
                name: "Serai",
                maxBounty: "$30,000",
                languages: ["Rust"],
                categories: ["AMM", "DEX", "L1", "Bridge"],
                difficulty: "Advanced",
                url: "https://immunefi.com/bug-bounty/serai/"
            },
            {
                platform: "Immunefi",
                name: "Hedera",
                maxBounty: "$30,000",
                languages: ["Solidity"],
                categories: ["L1"],
                difficulty: "Beginner",
                url: "https://immunefi.com/bug-bounty/hedera/"
            },
            {
                platform: "Immunefi",
                name: "OpenZeppelin",
                maxBounty: "$25,000",
                languages: ["Solidity"],
                categories: ["L1"],
                difficulty: "Intermediate",
                url: "https://immunefi.com/bug-bounty/openzeppelin/"
            },
            {
                platform: "Immunefi",
                name: "Enzyme Finance",
                maxBounty: "$200,000",
                languages: ["Solidity"],
                categories: ["Asset Management"],
                difficulty: "Intermediate",
                url: "https://immunefi.com/bug-bounty/enzyme/"
            },
            // Cantina Programs - CORRECTED LINKS
            {
                platform: "Cantina",
                name: "Uniswap",
                maxBounty: "$15,500,000",
                languages: ["Solidity"],
                categories: ["DEX", "AMM"],
                difficulty: "Advanced",
                url: "https://cantina.xyz/bounties/f9df94db-c7b1-434b-bb06-d1360abdd1be"
            },
            {
                platform: "Cantina",
                name: "Euler",
                maxBounty: "$7,500,000",
                languages: ["Solidity"],
                categories: ["Lending"],
                difficulty: "Advanced",
                url: "https://cantina.xyz/bounties/4d285eee-602e-440a-845e-25e155cec26a"
            },
            {
                platform: "Cantina",
                name: "Coinbase/Base",
                maxBounty: "$5,000,000",
                languages: ["Solidity"],
                categories: ["L2", "Bridge"],
                difficulty: "Advanced",
                url: "https://cantina.xyz/bounties/55316f42-3c5e-4746-9bd0-0f18dcbc344b"
            },
            {
                platform: "Cantina",
                name: "Morpho",
                maxBounty: "$2,500,000",
                languages: ["Solidity"],
                categories: ["Lending"],
                difficulty: "Advanced",
                url: "https://cantina.xyz/bounties/35a5f0a1-2ffd-432c-8f3b-77d169add8c3"
            },
            {
                platform: "Cantina",
                name: "Pendle",
                maxBounty: "$2,000,000",
                languages: ["Solidity"],
                categories: ["Yield Aggregator"],
                difficulty: "Advanced",
                url: "https://cantina.xyz/bounties/fb1f1c54-0cb9-4201-8791-fb1e78e6e600"
            },
            {
                platform: "Cantina",
                name: "OKX Labs",
                maxBounty: "$1,000,000",
                languages: ["Solidity"],
                categories: ["CEX"],
                difficulty: "Advanced",
                url: "https://cantina.xyz/bounties/00992789-fcd1-4bda-862e-463b0c73faa9"
            },
            {
                platform: "Cantina",
                name: "Monad",
                maxBounty: "$1,000,000",
                languages: ["Rust", "C/C++"],
                categories: ["L1"],
                difficulty: "Advanced",
                url: "https://cantina.xyz/bounties/31f19cea-dda2-4568-8f99-27dafd120c97"
            },
            {
                platform: "Cantina",
                name: "Ventuals",
                maxBounty: "$1,000,000",
                languages: ["Solidity"],
                categories: ["Liquid Staking"],
                difficulty: "Intermediate",
                url: "https://cantina.xyz/bounties/d1c3592e-f335-4235-94ac-c6bf6cdb50a3"
            },
            {
                platform: "Cantina",
                name: "Agglayer/Polygon",
                maxBounty: "$1,000,000",
                languages: ["Rust", "Solidity"],
                categories: ["L2", "Bridge"],
                difficulty: "Advanced",
                url: "https://cantina.xyz/bounties/3aaad22b-52ee-4bb2-bed2-4be53b0993cc"
            },
            {
                platform: "Cantina",
                name: "PancakeSwap",
                maxBounty: "$1,000,000",
                languages: ["Solidity"],
                categories: ["DEX", "AMM"],
                difficulty: "Advanced",
                url: "https://cantina.xyz/bounties/ea552420-8bd6-4119-815d-3d5203d0377a"
            }
        ];

        // Languages and Categories - COMPLETE LIST
        const LANGUAGES = [
            'Solidity', 'Rust', 'Go', 'TypeScript', 'Move', 
            'C/C++', 'JavaScript', 'Python', 'CosmWasm'
        ];

        const CATEGORIES = [
            'AMM', 'Asset Management', 'Bridge', 'CDP', 'CEX', 'DAO', 
            'Derivatives', 'DEX', 'DEX Aggregator', 'Gaming', 'Insurance',
            'L1', 'L2', 'Launchpad', 'Lending', 'Liquid Staking',
            'NFT Marketplace', 'Oracle', 'Perpetuals', 'Stablecoin',
            'Synthetic Assets', 'Wallet', 'Yield Aggregator', 'Zero-Knowledge Proofs'
        ];

        // State
        let currentProfile = null;

        // Navigation
        function showLanding() {
            document.getElementById('landing-page').classList.remove('hidden');
            document.getElementById('profile-connect').classList.add('hidden');
            document.getElementById('loading-state').classList.add('hidden');
            document.getElementById('results-page').classList.add('hidden');
            document.getElementById('manual-skills').classList.add('hidden');
        }

        function showProfileConnect() {
            document.getElementById('landing-page').classList.add('hidden');
            document.getElementById('profile-connect').classList.remove('hidden');
            document.getElementById('loading-state').classList.add('hidden');
            document.getElementById('results-page').classList.add('hidden');
            document.getElementById('manual-skills').classList.add('hidden');
        }

        function showLoading() {
            document.getElementById('landing-page').classList.add('hidden');
            document.getElementById('profile-connect').classList.add('hidden');
            document.getElementById('loading-state').classList.remove('hidden');
            document.getElementById('results-page').classList.add('hidden');
            document.getElementById('manual-skills').classList.add('hidden');
        }

        function showResults() {
            document.getElementById('landing-page').classList.add('hidden');
            document.getElementById('profile-connect').classList.add('hidden');
            document.getElementById('loading-state').classList.add('hidden');
            document.getElementById('results-page').classList.remove('hidden');
            document.getElementById('manual-skills').classList.add('hidden');
            window.scrollTo(0, 0);
        }

        function showManualSkills() {
            document.getElementById('landing-page').classList.add('hidden');
            document.getElementById('profile-connect').classList.add('hidden');
            document.getElementById('loading-state').classList.add('hidden');
            document.getElementById('results-page').classList.add('hidden');
            document.getElementById('manual-skills').classList.remove('hidden');
            initializeManualSkills();
        }

        // Test profiles data (for MVP without backend)
        const TEST_PROFILES = {
            haxatron: {
                immunefi: {
                    username: 'Haxatron',
                    earnings: 154408,
                    rank: 130,
                    findings: {
                        bbp: { critical: 0, high: 0, medium: 2, low: 0 },
                        audit_comps: { critical: 1, high: 0, medium: 1, low: 0, insights: 1 }
                    },
                    competitions: [
                        { name: 'VeChain Hayabusa Upgrade', reward: 88174 },
                        { name: 'Puffer Finance', reward: 240 }
                    ]
                },
                cantina: {
                    username: 'Haxatron',
                    earnings: 656891,
                    rank: 2,
                    findings: 133,
                    competitions: [
                        { name: 'Omni Network Cross-chain L1 Cosmos SDK Solidity Rust', reward: 230532 },
                        { name: 'Story Protocol L1 Cosmos SDK Solidity', reward: 81021 },
                        { name: 'Optimism Fault Proofs L2 OP Stack Solidity', reward: 92970 },
                        { name: 'Berachain Beacon-Kit L1 Cosmos SDK', reward: 89779 },
                        { name: 'Blast L2 OP Stack Solidity', reward: 49659 },
                        { name: 'Dango DEX CosmWasm Rust AMM', reward: 20415 },
                        { name: 'Ark NFT Bridge Cairo Solidity Bridge', reward: 3153 }
                    ]
                }
            },
            blockian: {
                immunefi: {
                    username: 'Blockian',
                    earnings: 870178,
                    rank: 20,
                    findings: {
                        bbp: { critical: 3, high: 7, medium: 4, low: 7 },
                        audit_comps: { critical: 19, high: 11, medium: 2, low: 5, insights: 13 }
                    },
                    competitions: [
                        { name: 'Shardeum Core III L1 JavaScript', reward: 94767 },
                        { name: 'Fuel Network Rust L1', reward: 70876 },
                        { name: 'Shardeum Ancillaries III', reward: 49315 },
                        { name: 'Movement Labs Move L1', reward: 16675 }
                    ]
                },
                cantina: {
                    username: 'Blockian',
                    earnings: 5465,
                    rank: 323,
                    findings: 1,
                    competitions: [
                        { name: 'Euler v2 Lending Solidity', reward: 5072 }
                    ]
                }
            },
            br0nz3p1ck4x3: {
                immunefi: {
                    username: 'br0nz3p1ck4x3',
                    earnings: 158030,
                    rank: 94,
                    findings: {
                        bbp: { critical: 2, high: 2, medium: 1, low: 1 },
                        audit_comps: { critical: 2, high: 0, medium: 0, low: 0, insights: 5 }
                    },
                    competitions: [
                        { name: 'Movement Labs Move L1', reward: 13713 },
                        { name: 'Ethereum Protocol L1 Consensus Solidity', reward: 4369 },
                        { name: 'Shardeum Ancillaries III JavaScript', reward: 500 }
                    ]
                },
                cantina: null
            },
            dontonka: {
                immunefi: {
                    username: 'dontonka',
                    earnings: 14138,
                    rank: 421,
                    findings: {
                        bbp: { critical: 0, high: 0, medium: 1, low: 0 },
                        audit_comps: { critical: 1, high: 1, medium: 1, low: 0, insights: 3 }
                    },
                    competitions: [
                        { name: 'ZeroLend Lending Solidity', reward: 5000 },
                        { name: 'DeGate DEX Solidity', reward: 4000 },
                        { name: 'Puffer Finance Staking Solidity', reward: 3000 }
                    ]
                },
                cantina: {
                    username: 'dontonka',
                    earnings: 408490,
                    rank: 5,
                    findings: 77,
                    competitions: [
                        { name: 'Omni Network Cross-chain L1 Cosmos SDK Go Solidity', reward: 124991 },
                        { name: 'Story Protocol L1 Cosmos SDK Go', reward: 45207 },
                        { name: 'Blast L2 OP Stack Solidity', reward: 43405 },
                        { name: 'Ronin Network L1 Go Gaming', reward: 30000 },
                        { name: 'Berachain Beacon-Kit L1 Cosmos SDK Go', reward: 25000 },
                        { name: 'Bitcoin Staking Scripts', reward: 10754 },
                        { name: 'ZetaChain L1 Cosmos SDK Go', reward: 3235 }
                    ]
                }
            }
        };

        // Profile Analysis with TEST DATA (avoids CORS issues)
        async function analyzeProfiles() {
            const immunefiUsername = document.getElementById('immunefiUsername').value.trim().toLowerCase();
            const cantinaUsername = document.getElementById('cantinaUsername').value.trim().toLowerCase();

            if (!immunefiUsername && !cantinaUsername) {
                alert('Please enter at least one username');
                return;
            }

            showLoading();

            // Simulate loading delay
            await new Promise(resolve => setTimeout(resolve, 1500));

            // Check test data
            const profileData = TEST_PROFILES[immunefiUsername] || TEST_PROFILES[cantinaUsername];

            if (!profileData) {
                alert(`Profile not found in demo database. Try one of these usernames:\n\n• haxatron\n• blockian\n• br0nz3p1ck4x3\n• dontonka\n\nNote: Live scraping requires a backend API (CORS restriction). This MVP uses test data.`);
                showProfileConnect();
                return;
            }

            currentProfile = aggregateProfile(profileData);
            displayResults(currentProfile);
            showResults();
        }

        function aggregateProfile(rawProfile) {
            const aggregated = {
                platforms_active: [],
                total_earnings: 0,
                total_findings: 0,
                findings_by_severity: {
                    critical: 0,
                    high: 0,
                    medium: 0,
                    low: 0,
                    insights: 0
                },
                competitions: [],
                skills: {
                    languages: new Set(),
                    categories: new Set(),
                    specializations: new Set()
                },
                immunefi_username: rawProfile.immunefi?.username || null,
                cantina_username: rawProfile.cantina?.username || null
            };

            // Aggregate Immunefi
            if (rawProfile.immunefi) {
                aggregated.platforms_active.push('Immunefi');
                aggregated.total_earnings += rawProfile.immunefi.earnings;
                
                const immunefiFindings = rawProfile.immunefi.findings;
                aggregated.findings_by_severity.critical += (immunefiFindings.bbp?.critical || 0) + (immunefiFindings.audit_comps?.critical || 0);
                aggregated.findings_by_severity.high += (immunefiFindings.bbp?.high || 0) + (immunefiFindings.audit_comps?.high || 0);
                aggregated.findings_by_severity.medium += (immunefiFindings.bbp?.medium || 0) + (immunefiFindings.audit_comps?.medium || 0);
                aggregated.findings_by_severity.low += (immunefiFindings.bbp?.low || 0) + (immunefiFindings.audit_comps?.low || 0);
                aggregated.findings_by_severity.insights += immunefiFindings.audit_comps?.insights || 0;
                
                aggregated.immunefi_rank = rawProfile.immunefi.rank;
                aggregated.competitions.push(...(rawProfile.immunefi.competitions || []));
            }

            // Aggregate Cantina
            if (rawProfile.cantina) {
                aggregated.platforms_active.push('Cantina');
                aggregated.total_earnings += rawProfile.cantina.earnings;
                aggregated.total_findings += rawProfile.cantina.findings || 0;
                aggregated.cantina_rank = rawProfile.cantina.rank;
                aggregated.competitions.push(...(rawProfile.cantina.competitions || []));
            }

            // Calculate total findings
            aggregated.total_findings += Object.values(aggregated.findings_by_severity).reduce((a, b) => a + b, 0);

            // Detect seniority (EARNINGS FIRST)
            aggregated.seniority = detectSeniority(aggregated);

            // Infer skills from competitions
            aggregated.skills = inferSkills(aggregated.competitions);

            return aggregated;
        }

        function inferSkills(competitions) {
            const skills = {
                languages: new Set(),
                categories: new Set(),
                specializations: new Set()
            };

            for (const comp of competitions) {
                const text = (comp.name || '').toLowerCase();

                // Languages
                if (text.includes('solidity')) skills.languages.add('Solidity');
                if (text.includes('rust')) skills.languages.add('Rust');
                if (text.includes('cairo')) skills.languages.add('Cairo');
                if (text.includes('cosmwasm') || text.includes('cosmos')) skills.languages.add('CosmWasm');
                if (text.includes('move')) skills.languages.add('Move');
                if (text.includes('javascript') || text.includes('typescript')) skills.languages.add('JavaScript');
                if (text.includes('go')) skills.languages.add('Go');
                if (text.includes('c++') || text.includes('cpp')) skills.languages.add('C/C++');

                // Categories
                if (text.includes('dex') || text.includes('amm')) skills.categories.add('DEX');
                if (text.includes('lending')) skills.categories.add('Lending');
                if (text.includes('staking')) skills.categories.add('Staking');
                if (text.includes('dao')) skills.categories.add('DAO');
                if (text.includes('yield')) skills.categories.add('Yield Aggregator');
                if (text.includes('bridge')) skills.categories.add('Bridge');
                if (text.includes('l1') || text.includes('layer 1')) skills.categories.add('L1');
                if (text.includes('l2') || text.includes('layer 2') || text.includes('op stack')) skills.categories.add('L2');
                if (text.includes('nft')) skills.categories.add('NFT Marketplace');
                if (text.includes('perpetual') || text.includes('perp')) skills.categories.add('Perpetuals');
                if (text.includes('liquid staking')) skills.categories.add('Liquid Staking');
            }

            return {
                languages: Array.from(skills.languages),
                categories: Array.from(skills.categories),
                specializations: Array.from(skills.specializations)
            };
        }

        function detectSeniority(profile) {
            const earnings = profile.total_earnings;
            const criticals = profile.findings_by_severity.critical;
            
            // EARNINGS FIRST - Primary signal
            if (earnings >= 50000) {
                return {
                    level: 'ADVANCED',
                    confidence: 99,
                    reasoning: `Total earnings: $${earnings.toLocaleString()}`
                };
            }

            if (earnings >= 5000 && earnings < 50000) {
                return {
                    level: 'INTERMEDIATE',
                    confidence: 95,
                    reasoning: `Total earnings: $${earnings.toLocaleString()}`
                };
            }

            if (criticals >= 3 && earnings >= 20000) {
                return {
                    level: 'ADVANCED',
                    confidence: 90,
                    reasoning: `${criticals} Critical findings + $${earnings.toLocaleString()}`
                };
            }

            // Default to Novice
            return {
                level: 'NOVICE',
                confidence: 80,
                reasoning: `Total earnings: $${earnings.toLocaleString()}`
            };
        }

        // Display results - UPDATED UI
        function displayResults(profile) {
            // Determine display username (alphabetical priority if different on platforms)
            let displayUsername = 'Researcher';
            
            const immunefiUser = profile.immunefi_username;
            const cantinaUser = profile.cantina_username;
            
            if (immunefiUser && cantinaUser && immunefiUser.toLowerCase() !== cantinaUser.toLowerCase()) {
                // Both exist and different - pick alphabetically first
                displayUsername = immunefiUser.toLowerCase() < cantinaUser.toLowerCase() ? immunefiUser : cantinaUser;
            } else {
                // Same username or only one exists
                displayUsername = immunefiUser || cantinaUser || 'Researcher';
            }

            const summaryHTML = `
                <!-- Username Display -->
                <div class="mb-6">
                    <h2 class="text-2xl font-semibold text-gray-700">Viewing profile: <span class="gradient-text">${displayUsername}</span></h2>
                </div>

                <!-- Seniority Badge and Earnings - CENTERED -->
                <div class="text-center mb-10">
                    <div class="inline-flex items-center gap-3 mb-4">
                        <span class="badge-${profile.seniority.level.toLowerCase()} text-white px-6 py-3 rounded-full text-lg font-bold">
                            ${profile.seniority.level}
                        </span>
                    </div>
                    <div class="mb-2">
                        <div class="text-6xl font-bold gradient-text">$${profile.total_earnings.toLocaleString()}</div>
                        <div class="text-xl text-gray-600 mt-2">Total Earnings</div>
                    </div>
                    <p class="text-gray-600 mt-4">${profile.seniority.reasoning}</p>
                </div>
                <div class="grid md:grid-cols-2 gap-6 mb-8">
                    <!-- Platforms -->
                    <div class="bg-gradient-to-br from-purple-50 to-purple-100 p-6 rounded-2xl border-2 border-purple-200">
                        <div class="text-3xl font-bold text-purple-600">${profile.platforms_active.length}</div>
                        <div class="text-gray-700 font-semibold mb-3">Platforms Active</div>
                        <div class="space-y-2">
                            ${profile.platforms_active.map(p => `
                                <div class="flex items-center gap-2">
                                    <svg class="w-5 h-5 text-purple-600" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg>
                                    <span class="font-semibold">${p}</span>
                                    ${p === 'Immunefi' && profile.immunefi_rank ? `<span class="text-sm text-gray-600">(Rank: ${profile.immunefi_rank})</span>` : ''}
                                    ${p === 'Cantina' && profile.cantina_rank ? `<span class="text-sm text-gray-600">(Rank: ${profile.cantina_rank})</span>` : ''}
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- Findings Summary Table -->
                    <div class="bg-gradient-to-br from-sky-50 to-sky-100 p-6 rounded-2xl border-2 border-sky-200">
                        <div class="text-3xl font-bold text-sky-600 mb-3">${profile.total_findings}</div>
                        <div class="text-gray-700 font-semibold mb-4">Total Findings</div>
                        <div class="space-y-2">
                            ${profile.findings_by_severity.critical > 0 ? `
                                <div class="flex justify-between items-center bg-red-100 px-3 py-2 rounded-lg">
                                    <span class="font-semibold text-red-700">Critical</span>
                                    <span class="font-bold text-red-700">${profile.findings_by_severity.critical}</span>
                                </div>
                            ` : ''}
                            ${profile.findings_by_severity.high > 0 ? `
                                <div class="flex justify-between items-center bg-orange-100 px-3 py-2 rounded-lg">
                                    <span class="font-semibold text-orange-700">High</span>
                                    <span class="font-bold text-orange-700">${profile.findings_by_severity.high}</span>
                                </div>
                            ` : ''}
                            ${profile.findings_by_severity.medium > 0 ? `
                                <div class="flex justify-between items-center bg-yellow-100 px-3 py-2 rounded-lg">
                                    <span class="font-semibold text-yellow-700">Medium</span>
                                    <span class="font-bold text-yellow-700">${profile.findings_by_severity.medium}</span>
                                </div>
                            ` : ''}
                            ${profile.findings_by_severity.low > 0 ? `
                                <div class="flex justify-between items-center bg-gray-100 px-3 py-2 rounded-lg">
                                    <span class="font-semibold text-gray-700">Low</span>
                                    <span class="font-bold text-gray-700">${profile.findings_by_severity.low}</span>
                                </div>
                            ` : ''}
                            ${profile.findings_by_severity.insights > 0 ? `
                                <div class="flex justify-between items-center bg-blue-100 px-3 py-2 rounded-lg">
                                    <span class="font-semibold text-blue-700">Insights</span>
                                    <span class="font-bold text-blue-700">${profile.findings_by_severity.insights}</span>
                                </div>
                            ` : ''}
                        </div>
                        ${profile.cantina_rank ? `
                            <div class="mt-3 p-2 bg-purple-50 rounded-lg border border-purple-200">
                                <p class="text-xs text-purple-700">
                                    <span class="font-semibold">Note:</span> Cantina severity breakdown in development. Currently showing Immunefi severities only.
                                </p>
                            </div>
                        ` : ''}
                    </div>
                </div>

                <!-- Editable Skills Section -->
                <div class="bg-gradient-to-br from-indigo-50 to-indigo-100 p-6 rounded-2xl border-2 border-indigo-200 mb-6">
                    <div class="flex justify-between items-center mb-4">
                        <h4 class="font-bold text-lg text-gray-800">Your Tech Stack & Expertise</h4>
                        <button onclick="editSkills()" class="text-sm bg-white hover:bg-gray-50 text-indigo-600 font-semibold px-4 py-2 rounded-lg border-2 border-indigo-300 transition-all">
                            ✏️ Edit Skills
                        </button>
                    </div>
                    <div id="skills-display">
                        ${profile.skills.languages.length > 0 ? `
                            <div class="mb-4">
                                <div class="text-sm text-gray-600 mb-2">LANGUAGES:</div>
                                <div class="flex flex-wrap gap-2">
                                    ${profile.skills.languages.map(lang => `
                                        <span class="bg-white px-3 py-1 rounded-full text-sm font-semibold text-gray-700 border border-indigo-300">${lang}</span>
                                    `).join('')}
                                </div>
                            </div>
                        ` : '<p class="text-gray-600 text-sm">Click "Edit Skills" to add your languages and expertise areas</p>'}
                        ${profile.skills.categories.length > 0 || profile.skills.specializations.length > 0 ? `
                            <div>
                                <div class="text-sm text-gray-600 mb-2">EXPERTISE:</div>
                                <div class="flex flex-wrap gap-2">
                                    ${[...profile.skills.categories, ...profile.skills.specializations].map(cat => `
                                        <span class="bg-white px-3 py-1 rounded-full text-sm font-semibold text-gray-700 border border-indigo-300">${cat}</span>
                                    `).join('')}
                                </div>
                            </div>
                        ` : ''}
                    </div>
                </div>
            `;
            document.getElementById('profile-summary').innerHTML = summaryHTML;

            // Generate recommendations
            const recommendations = generateRecommendations(profile);
            displayRecommendations(recommendations);
        }

        // Edit skills modal/inline
        function editSkills() {
            const modal = `
                <div class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4" onclick="if(event.target===this) closeSkillsModal()">
                    <div class="bg-white rounded-3xl shadow-2xl p-8 max-w-4xl w-full max-h-[90vh] overflow-y-auto" onclick="event.stopPropagation()">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-2xl font-bold gradient-text">Edit Your Skills</h3>
                            <button onclick="closeSkillsModal()" class="text-gray-500 hover:text-gray-700">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                        
                        <div class="mb-6">
                            <h4 class="font-bold text-lg mb-3">Language Proficiency</h4>
                            <p class="text-sm text-gray-600 mb-4">Rate your confidence: 1 = Novice, 5 = Expert</p>
                            <div class="space-y-4" id="modal-languages">
                                ${LANGUAGES.map(lang => {
                                    const currentLevel = currentProfile.skills.languages.includes(lang) ? 3 : 0;
                                    return `
                                        <div class="bg-gray-50 p-4 rounded-xl">
                                            <div class="flex justify-between items-center mb-2">
                                                <span class="font-semibold text-gray-800">${lang}</span>
                                                <span class="text-sm font-bold text-sky-600" id="modal-lang-${lang.replace(/[^a-zA-Z]/g,'')}-value">${currentLevel}</span>
                                            </div>
                                            <input type="range" min="0" max="5" value="${currentLevel}" class="slider w-full modal-lang-slider" 
                                                   data-lang="${lang}" 
                                                   oninput="document.getElementById('modal-lang-${lang.replace(/[^a-zA-Z]/g,'')}-value').textContent = this.value">
                                            <div class="flex justify-between text-xs text-gray-500 mt-1">
                                                <span>None</span>
                                                <span>Novice</span>
                                                <span>Intermediate</span>
                                                <span>Advanced</span>
                                                <span>Expert</span>
                                            </div>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>

                        <div class="mb-6">
                            <h4 class="font-bold text-lg mb-3">Product Categories</h4>
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-2" id="modal-categories">
                                ${CATEGORIES.map(cat => `
                                    <label class="flex items-center bg-gray-50 p-2 rounded-lg cursor-pointer hover:bg-gray-100">
                                        <input type="checkbox" value="${cat}" class="mr-2 modal-cat" ${currentProfile.skills.categories.includes(cat) || currentProfile.skills.specializations.includes(cat) ? 'checked' : ''}>
                                        <span class="text-sm font-semibold">${cat}</span>
                                    </label>
                                `).join('')}
                            </div>
                        </div>

                        <button onclick="saveSkills()" class="w-full bg-gradient-to-r from-sky-500 to-purple-600 hover:from-sky-600 hover:to-purple-700 text-white font-bold px-6 py-3 rounded-xl transition-all">
                            Save Changes
                        </button>
                    </div>
                </div>
            `;
            
            const modalDiv = document.createElement('div');
            modalDiv.id = 'skills-modal';
            modalDiv.innerHTML = modal;
            document.body.appendChild(modalDiv);
        }

        function closeSkillsModal() {
            const modal = document.getElementById('skills-modal');
            if (modal) modal.remove();
        }

        function saveSkills() {
            // Get languages with proficiency >= 1
            const langSliders = document.querySelectorAll('.modal-lang-slider');
            const selectedLangs = Array.from(langSliders)
                .filter(slider => parseInt(slider.value) >= 1)
                .map(slider => slider.dataset.lang);
            
            const selectedCats = Array.from(document.querySelectorAll('.modal-cat:checked')).map(el => el.value);
            
            currentProfile.skills.languages = selectedLangs;
            currentProfile.skills.categories = selectedCats;
            currentProfile.skills.specializations = [];
            
            closeSkillsModal();
            displayResults(currentProfile);
        }

        // Matching algorithm
        function generateRecommendations(profile) {
            const scored = PROGRAMS.map(program => {
                let score = 0;
                let reasons = [];

                // Language match (60 points per match - PRIMARY)
                const langMatches = program.languages.filter(lang => 
                    profile.skills.languages.some(userLang => userLang.includes(lang) || lang.includes(userLang))
                );
                if (langMatches.length > 0) {
                    score += langMatches.length * 60;
                    reasons.push(`Matches your ${langMatches.join(', ')} skills`);
                }

                // Category match (25 points per match)
                const catMatches = program.categories.filter(cat => 
                    profile.skills.categories.includes(cat) || 
                    profile.skills.specializations.some(spec => spec.includes(cat) || cat.includes(spec))
                );
                if (catMatches.length > 0) {
                    score += catMatches.length * 25;
                    reasons.push(`Expertise in ${catMatches.join(', ')}`);
                }

                // Experience level match (30 points bonus, penalties for mismatch)
                const userLevel = profile.seniority.level;
                const programLevel = program.difficulty;
                
                if (userLevel === programLevel) {
                    score += 30;
                    reasons.push(`Perfect experience match (${programLevel})`);
                } else if (userLevel === 'NOVICE' && programLevel === 'Advanced') {
                    score -= 40;
                } else if (userLevel === 'INTERMEDIATE' && programLevel === 'Advanced') {
                    score -= 15;
                } else if (userLevel === 'ADVANCED' && programLevel === 'Beginner') {
                    score -= 10;
                }

                return { ...program, score, matchReasons: reasons };
            });

            // Filter out programs with score < 20 (no meaningful match)
            const filtered = scored.filter(p => p.score >= 20);

            // Sort by score descending
            filtered.sort((a, b) => b.score - a.score);

            return filtered.slice(0, 10); // Top 10
        }

        function displayRecommendations(programs) {
            const html = programs.map((program, index) => `
                <div class="bg-white/90 backdrop-blur-sm rounded-2xl shadow-lg p-6 border-2 ${
                    index === 0 ? 'border-yellow-400' : 
                    index === 1 ? 'border-gray-300' : 
                    index === 2 ? 'border-orange-400' : 
                    'border-sky-200'
                } card-hover">
                    ${index < 3 ? `
                        <div class="inline-block mb-3">
                            <span class="bg-gradient-to-r ${
                                index === 0 ? 'from-yellow-400 to-yellow-600' : 
                                index === 1 ? 'from-gray-400 to-gray-600' : 
                                'from-orange-400 to-orange-600'
                            } text-white px-3 py-1 rounded-full text-xs font-bold">
                                ${index === 0 ? '🥇 BEST MATCH' : index === 1 ? '🥈 GREAT FIT' : '🥉 SOLID CHOICE'}
                            </span>
                        </div>
                    ` : ''}
                    
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h3 class="text-2xl font-bold text-gray-800 mb-1">${program.name}</h3>
                            <span class="inline-block px-3 py-1 rounded-full text-xs font-semibold ${
                                program.platform === 'Immunefi' ? 'bg-sky-100 text-sky-700' : 'bg-purple-100 text-purple-700'
                            }">
                                ${program.platform}
                            </span>
                        </div>
                        <div class="text-right">
                            <div class="text-2xl font-bold text-green-600">${program.maxBounty}</div>
                            <div class="text-xs text-gray-500">Max Bounty</div>
                        </div>
                    </div>

                    ${program.description ? `<p class="text-gray-600 mb-4 text-sm">${program.description}</p>` : ''}

                    <!-- Why this fits you -->
                    ${program.matchReasons && program.matchReasons.length > 0 ? `
                        <div class="mb-4 p-3 bg-green-50 rounded-lg border-2 border-green-200">
                            <div class="text-xs font-bold text-green-700 mb-1">WHY THIS FITS YOU:</div>
                            <div class="text-sm text-green-700">
                                ${program.matchReasons.join(' • ')}
                            </div>
                        </div>
                    ` : ''}

                    <div class="mb-4">
                        <div class="text-xs text-gray-500 mb-2">TECH STACK</div>
                        <div class="flex flex-wrap gap-2">
                            ${program.languages.map(lang => `
                                <span class="bg-indigo-100 text-indigo-700 px-2 py-1 rounded text-xs font-semibold">${lang}</span>
                            `).join('')}
                        </div>
                    </div>

                    <div class="mb-4">
                        <div class="text-xs text-gray-500 mb-2">CATEGORIES</div>
                        <div class="flex flex-wrap gap-2">
                            ${program.categories.map(cat => `
                                <span class="bg-pink-100 text-pink-700 px-2 py-1 rounded text-xs font-semibold">${cat}</span>
                            `).join('')}
                        </div>
                    </div>

                    <div class="flex justify-between items-center pt-4 border-t border-gray-200">
                        <span class="text-sm ${
                            program.difficulty === 'Advanced' ? 'text-red-600' :
                            program.difficulty === 'Intermediate' ? 'text-orange-600' :
                            'text-green-600'
                        } font-semibold">
                            ${program.difficulty}
                        </span>
                        <a href="${program.url}" target="_blank" class="bg-gradient-to-r from-sky-500 to-purple-600 hover:from-sky-600 hover:to-purple-700 text-white font-bold px-6 py-2 rounded-lg text-sm transition-all transform hover:scale-105">
                            View Program →
                        </a>
                    </div>
                </div>
            `).join('');

            document.getElementById('recommendations-grid').innerHTML = html;
        }

        // Manual skills entry
        function initializeManualSkills() {
            // Languages with sliders
            const langHTML = LANGUAGES.map(lang => `
                <div class="bg-white p-4 rounded-xl border-2 border-gray-200">
                    <div class="flex justify-between items-center mb-2">
                        <span class="font-semibold text-gray-800">${lang}</span>
                        <span class="text-sm font-bold text-sky-600" id="lang-${lang.replace(/[^a-zA-Z]/g,'')}-value">3</span>
                    </div>
                    <input type="range" min="1" max="5" value="3" class="slider w-full manual-lang-slider" 
                           data-lang="${lang}" 
                           oninput="document.getElementById('lang-${lang.replace(/[^a-zA-Z]/g,'')}-value').textContent = this.value">
                    <div class="flex justify-between text-xs text-gray-500 mt-1">
                        <span>Novice</span>
                        <span>Expert</span>
                    </div>
                </div>
            `).join('');
            document.getElementById('manual-languages').innerHTML = langHTML;

            // Categories
            const catHTML = CATEGORIES.map(cat => `
                <label class="flex items-center bg-white p-3 rounded-xl border-2 border-gray-300 cursor-pointer hover:border-purple-500 transition-all">
                    <input type="checkbox" value="${cat}" class="mr-2 manual-cat">
                    <span class="font-semibold text-gray-700 text-sm">${cat}</span>
                </label>
            `).join('');
            document.getElementById('manual-categories').innerHTML = catHTML;

            // Experience levels
            const expHTML = `
                <label class="flex items-center space-x-3 cursor-pointer bg-white p-4 rounded-xl border-2 border-gray-300 hover:border-purple-400 transition-all">
                    <input type="radio" name="experience" value="NOVICE" class="text-purple-600">
                    <div>
                        <div class="font-bold text-gray-800">Novice</div>
                        <div class="text-sm text-gray-600">New to bug hunting, learning the basics</div>
                    </div>
                </label>
                <label class="flex items-center space-x-3 cursor-pointer bg-white p-4 rounded-xl border-2 border-gray-300 hover:border-purple-400 transition-all">
                    <input type="radio" name="experience" value="INTERMEDIATE" checked class="text-purple-600">
                    <div>
                        <div class="font-bold text-gray-800">Intermediate</div>
                        <div class="text-sm text-gray-600">Found some bugs, familiar with common vulnerabilities</div>
                    </div>
                </label>
                <label class="flex items-center space-x-3 cursor-pointer bg-white p-4 rounded-xl border-2 border-gray-300 hover:border-purple-400 transition-all">
                    <input type="radio" name="experience" value="ADVANCED" class="text-purple-600">
                    <div>
                        <div class="font-bold text-gray-800">Advanced</div>
                        <div class="text-sm text-gray-600">Experienced researcher with multiple successful reports</div>
                    </div>
                </label>
            `;
            document.getElementById('manual-experience').innerHTML = expHTML;
        }

        function generateManualRecommendations() {
            // Get languages with proficiency >= 3
            const langSliders = document.querySelectorAll('.manual-lang-slider');
            const selectedLangs = Array.from(langSliders)
                .filter(slider => parseInt(slider.value) >= 3)
                .map(slider => slider.dataset.lang);

            const selectedCats = Array.from(document.querySelectorAll('.manual-cat:checked')).map(el => el.value);
            const selectedExp = document.querySelector('input[name="experience"]:checked')?.value || 'INTERMEDIATE';

            if (selectedLangs.length === 0) {
                alert('Please rate at least one language with 3+ proficiency');
                return;
            }

            const manualProfile = {
                seniority: {
                    level: selectedExp,
                    confidence: 80,
                    reasoning: 'Based on self-reported experience level'
                },
                skills: {
                    languages: selectedLangs,
                    categories: selectedCats,
                    specializations: []
                },
                total_earnings: 0,
                total_findings: 0,
                findings_by_severity: { critical: 0, high: 0, medium: 0, low: 0, insights: 0 },
                platforms_active: ['Manual Entry']
            };

            currentProfile = manualProfile;
            displayResults(manualProfile);
            showResults();
        }
    </script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <met<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PanoptesHQ - AI-Powered Bug Bounty Recommendations</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 50%, #fef3c7 100%);
            min-height: 100vh;
        }
        .gradient-text {
            background: linear-gradient(135deg, #0ea5e9 0%, #8b5cf6 50%, #ec4899 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgba(14, 165, 233, 0.2);
        }
        .badge-advanced {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        .badge-intermediate {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }
        .badge-novice {
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
        }
        .slider {
            -webkit-appearance: none;
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: #e5e7eb;
            outline: none;
        }
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #0ea5e9;
            cursor: pointer;
        }
        .slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #0ea5e9;
            cursor: pointer;
            border: none;
        }
    </style>
</head>
<body class="text-gray-900">
    
    <!-- Landing Page -->
    <div id="landing-page" class="min-h-screen flex items-center justify-center px-4">
        <div class="max-w-5xl w-full text-center">
            <h1 class="text-6xl md:text-7xl font-bold mb-6">
                <span class="gradient-text">PanoptesHQ</span>
            </h1>
            <p class="text-3xl md:text-4xl text-gray-700 font-semibold mb-4">
                Stop choosing where to hunt
            </p>
            <p class="text-xl text-gray-600 mb-12 max-w-2xl mx-auto">
                Connect your bug bounty profiles and get AI-powered recommendations tailored to your skills and experience
            </p>
            
            <div class="grid md:grid-cols-3 gap-6 mb-12">
                <div class="bg-white/80 backdrop-blur-sm p-8 rounded-2xl shadow-lg border-2 border-sky-200">
                    <div class="w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-sky-400 to-sky-600 rounded-2xl flex items-center justify-center">
                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-bold mb-3 text-gray-800">Auto-Profile Sync</h3>
                    <p class="text-gray-600">Connect Immunefi & Cantina to auto-detect your skills, experience level, and expertise areas</p>
                </div>
                <div class="bg-white/80 backdrop-blur-sm p-8 rounded-2xl shadow-lg border-2 border-purple-200">
                    <div class="w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-purple-400 to-purple-600 rounded-2xl flex items-center justify-center">
                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-bold mb-3 text-gray-800">Smart Matching</h3>
                    <p class="text-gray-600">Get personalized program recommendations based on your tech stack and proven track record</p>
                </div>
                <div class="bg-white/80 backdrop-blur-sm p-8 rounded-2xl shadow-lg border-2 border-pink-200">
                    <div class="w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-pink-400 to-pink-600 rounded-2xl flex items-center justify-center">
                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-bold mb-3 text-gray-800">Maximize Earnings</h3>
                    <p class="text-gray-600">Hunt programs that match your strengths from both Immunefi and Cantina platforms</p>
                </div>
            </div>
            
            <button onclick="showProfileConnect()" class="bg-gradient-to-r from-sky-500 to-purple-600 hover:from-sky-600 hover:to-purple-700 text-white font-bold px-12 py-5 rounded-2xl text-xl transition-all transform hover:scale-105 shadow-xl">
                Connect Profiles →
            </button>
            
            <p class="text-gray-500 mt-6">Free • 2 minutes • No signup required</p>
        </div>
    </div>

    <!-- Profile Connection -->
    <div id="profile-connect" class="hidden min-h-screen py-16 px-4">
        <div class="max-w-2xl mx-auto">
            <button onclick="showLanding()" class="text-sky-600 hover:text-sky-700 font-semibold mb-6">← Back</button>
            
            <div class="bg-white/90 backdrop-blur-sm rounded-3xl shadow-2xl p-10 border-2 border-sky-100">
                <h2 class="text-4xl font-bold mb-3 gradient-text">Connect Your Profiles</h2>
                <p class="text-gray-600 mb-10">We'll analyze your activity to personalize recommendations</p>

                <div class="space-y-6">
                    <!-- Immunefi -->
                    <div>
                        <label class="block text-lg font-semibold text-gray-800 mb-3">
                            <span class="inline-flex items-center">
                                <svg class="w-6 h-6 mr-2 text-sky-600" fill="currentColor" viewBox="0 0 20 20"><path d="M10 2a8 8 0 100 16 8 8 0 000-16zm0 14a6 6 0 110-12 6 6 0 010 12z"/></svg>
                                Immunefi Username
                            </span>
                        </label>
                        <input 
                            type="text" 
                            id="immunefiUsername" 
                            class="w-full bg-white border-2 border-gray-300 rounded-xl px-6 py-4 text-gray-900 focus:outline-none focus:border-sky-500 text-lg"
                            placeholder="e.g., Haxatron"
                        >
                        <p class="text-sm text-gray-500 mt-2">Find it at: immunefi.com/profile/[username]</p>
                    </div>

                    <!-- Cantina -->
                    <div>
                        <label class="block text-lg font-semibold text-gray-800 mb-3">
                            <span class="inline-flex items-center">
                                <svg class="w-6 h-6 mr-2 text-purple-600" fill="currentColor" viewBox="0 0 20 20"><path d="M10 2a8 8 0 100 16 8 8 0 000-16zm0 14a6 6 0 110-12 6 6 0 010 12z"/></svg>
                                Cantina Username (Optional)
                            </span>
                        </label>
                        <input 
                            type="text" 
                            id="cantinaUsername" 
                            class="w-full bg-white border-2 border-gray-300 rounded-xl px-6 py-4 text-gray-900 focus:outline-none focus:border-purple-500 text-lg"
                            placeholder="e.g., Haxatron"
                        >
                        <p class="text-sm text-gray-500 mt-2">Find it at: cantina.xyz/u/[username]</p>
                    </div>
                </div>

                <div class="mt-10 p-6 bg-sky-50 rounded-xl border-2 border-sky-200">
                    <p class="text-sm text-gray-700">
                        <span class="font-semibold">Note:</span> We'll fetch your public earnings, findings, and programs to recommend the best bounties for you. No login required.
                    </p>
                </div>

                <button 
                    onclick="analyzeProfiles()" 
                    class="w-full mt-8 bg-gradient-to-r from-sky-500 to-purple-600 hover:from-sky-600 hover:to-purple-700 text-white font-bold px-8 py-5 rounded-2xl text-xl transition-all transform hover:scale-105 shadow-lg"
                >
                    Analyze My Profiles →
                </button>

                <p class="text-center text-gray-500 mt-6">or</p>

                <button 
                    onclick="showManualSkills()" 
                    class="w-full mt-4 bg-white hover:bg-gray-50 text-gray-700 font-semibold px-8 py-4 rounded-2xl text-lg border-2 border-gray-300 transition-all"
                >
                    Enter Skills Manually
                </button>
            </div>
        </div>
    </div>

    <!-- Loading State -->
    <div id="loading-state" class="hidden min-h-screen flex items-center justify-center px-4">
        <div class="text-center">
            <div class="inline-block animate-spin rounded-full h-16 w-16 border-4 border-sky-500 border-t-transparent mb-6"></div>
            <h3 class="text-2xl font-bold text-gray-800 mb-2">Analyzing Your Profiles...</h3>
            <p class="text-gray-600" id="loading-message">Fetching data from Immunefi</p>
        </div>
    </div>

    <!-- Profile Results + Recommendations -->
    <div id="results-page" class="hidden min-h-screen py-16 px-4">
        <div class="max-w-6xl mx-auto">
            <button onclick="showProfileConnect()" class="text-sky-600 hover:text-sky-700 font-semibold mb-6">← Try Different Profiles</button>
            
            <!-- Aggregated Profile Card -->
            <div id="profile-summary" class="bg-white/90 backdrop-blur-sm rounded-3xl shadow-2xl p-10 mb-10 border-2 border-sky-100">
                <!-- Will be populated by JavaScript -->
            </div>

            <!-- Recommendations -->
            <div>
                <h2 class="text-3xl font-bold mb-6 gradient-text">Your Personalized Recommendations</h2>
                <p class="text-gray-600 mb-8">Based on your skills and experience, here are the top programs for you:</p>
                
                <div id="recommendations-grid" class="grid md:grid-cols-2 gap-6">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Manual Skills Entry (Fallback) -->
    <div id="manual-skills" class="hidden min-h-screen py-16 px-4">
        <div class="max-w-4xl mx-auto">
            <button onclick="showProfileConnect()" class="text-sky-600 hover:text-sky-700 font-semibold mb-6">← Back</button>
            
            <div class="bg-white/90 backdrop-blur-sm rounded-3xl shadow-2xl p-10 border-2 border-sky-100">
                <h2 class="text-4xl font-bold mb-3 gradient-text">Tell Us Your Skills</h2>
                <p class="text-gray-600 mb-10">Rate your proficiency in each language and select your expertise areas</p>

                <!-- Languages with Proficiency Levels -->
                <div class="mb-10">
                    <h3 class="text-2xl font-bold mb-6 text-gray-800">Language Proficiency</h3>
                    <p class="text-sm text-gray-600 mb-6">Rate your confidence: 1 = Novice, 5 = Expert</p>
                    <div class="space-y-6" id="manual-languages">
                        <!-- Will be populated -->
                    </div>
                </div>

                <!-- Product Categories -->
                <div class="mb-10">
                    <h3 class="text-2xl font-bold mb-6 text-gray-800">Product Expertise</h3>
                    <p class="text-sm text-gray-600 mb-6">Select all categories you're familiar with</p>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-3" id="manual-categories">
                        <!-- Will be populated -->
                    </div>
                </div>

                <!-- Experience Level -->
                <div class="mb-10">
                    <h3 class="text-2xl font-bold mb-6 text-gray-800">Experience Level</h3>
                    <div class="space-y-3" id="manual-experience">
                        <!-- Will be populated -->
                    </div>
                </div>

                <button 
                    onclick="generateManualRecommendations()" 
                    class="w-full bg-gradient-to-r from-sky-500 to-purple-600 hover:from-sky-600 hover:to-purple-700 text-white font-bold px-8 py-5 rounded-2xl text-xl transition-all transform hover:scale-105 shadow-lg"
                >
                    Get Recommendations →
                </button>
            </div>
        </div>
    </div>

    <script>
        // Program Database - UPDATED WITH CORRECT CANTINA LINKS
        const PROGRAMS = [
            // Immunefi Programs
            {
                platform: "Immunefi",
                name: "GMX",
                description: "Decentralized spot and perpetual exchange with low swap fees and zero price impact trades.",
                maxBounty: "$5,000,000",
                languages: ["Solidity", "JavaScript", "TypeScript"],
                categories: ["AMM", "DEX", "Perpetuals"],
                difficulty: "Advanced",
                url: "https://immunefi.com/bug-bounty/gmx/"
            },
            {
                platform: "Immunefi",
                name: "Olympus",
                maxBounty: "$3,333,333",
                languages: ["Solidity"],
                categories: ["DAO"],
                difficulty: "Advanced",
                url: "https://immunefi.com/bug-bounty/olympus/"
            },
            {
                platform: "Immunefi",
                name: "Alchemix",
                maxBounty: "$300,000",
                languages: ["Solidity"],
                categories: ["DAO", "Synthetic Assets", "Lending"],
                difficulty: "Intermediate",
                url: "https://immunefi.com/bug-bounty/alchemix/"
            },
            {
                platform: "Immunefi",
                name: "Yearn Finance",
                maxBounty: "$200,000",
                languages: ["Solidity"],
                categories: ["Lending", "Yield Aggregator"],
                difficulty: "Intermediate",
                url: "https://immunefi.com/bug-bounty/yearn/"
            },
            {
                platform: "Immunefi",
                name: "Tranchess",
                maxBounty: "$200,000",
                languages: ["Solidity", "JavaScript"],
                categories: ["Asset Management", "Yield Aggregator"],
                difficulty: "Intermediate",
                url: "https://immunefi.com/bug-bounty/tranchess/"
            },
            {
                platform: "Immunefi",
                name: "monero-oxide",
                maxBounty: "$100,000",
                languages: ["Rust"],
                categories: ["L1"],
                difficulty: "Advanced",
                url: "https://immunefi.com/bug-bounty/monero-oxide/"
            },
            {
                platform: "Immunefi",
                name: "Serai",
                maxBounty: "$30,000",
                languages: ["Rust"],
                categories: ["AMM", "DEX", "L1", "Bridge"],
                difficulty: "Advanced",
                url: "https://immunefi.com/bug-bounty/serai/"
            },
            {
                platform: "Immunefi",
                name: "Hedera",
                maxBounty: "$30,000",
                languages: ["Solidity"],
                categories: ["L1"],
                difficulty: "Beginner",
                url: "https://immunefi.com/bug-bounty/hedera/"
            },
            {
                platform: "Immunefi",
                name: "OpenZeppelin",
                maxBounty: "$25,000",
                languages: ["Solidity"],
                categories: ["L1"],
                difficulty: "Intermediate",
                url: "https://immunefi.com/bug-bounty/openzeppelin/"
            },
            {
                platform: "Immunefi",
                name: "Enzyme Finance",
                maxBounty: "$200,000",
                languages: ["Solidity"],
                categories: ["Asset Management"],
                difficulty: "Intermediate",
                url: "https://immunefi.com/bug-bounty/enzyme/"
            },
            // Cantina Programs - CORRECTED LINKS
            {
                platform: "Cantina",
                name: "Uniswap",
                maxBounty: "$15,500,000",
                languages: ["Solidity"],
                categories: ["DEX", "AMM"],
                difficulty: "Advanced",
                url: "https://cantina.xyz/bounties/f9df94db-c7b1-434b-bb06-d1360abdd1be"
            },
            {
                platform: "Cantina",
                name: "Euler",
                maxBounty: "$7,500,000",
                languages: ["Solidity"],
                categories: ["Lending"],
                difficulty: "Advanced",
                url: "https://cantina.xyz/bounties/4d285eee-602e-440a-845e-25e155cec26a"
            },
            {
                platform: "Cantina",
                name: "Coinbase/Base",
                maxBounty: "$5,000,000",
                languages: ["Solidity"],
                categories: ["L2", "Bridge"],
                difficulty: "Advanced",
                url: "https://cantina.xyz/bounties/55316f42-3c5e-4746-9bd0-0f18dcbc344b"
            },
            {
                platform: "Cantina",
                name: "Morpho",
                maxBounty: "$2,500,000",
                languages: ["Solidity"],
                categories: ["Lending"],
                difficulty: "Advanced",
                url: "https://cantina.xyz/bounties/35a5f0a1-2ffd-432c-8f3b-77d169add8c3"
            },
            {
                platform: "Cantina",
                name: "Pendle",
                maxBounty: "$2,000,000",
                languages: ["Solidity"],
                categories: ["Yield Aggregator"],
                difficulty: "Advanced",
                url: "https://cantina.xyz/bounties/fb1f1c54-0cb9-4201-8791-fb1e78e6e600"
            },
            {
                platform: "Cantina",
                name: "OKX Labs",
                maxBounty: "$1,000,000",
                languages: ["Solidity"],
                categories: ["CEX"],
                difficulty: "Advanced",
                url: "https://cantina.xyz/bounties/00992789-fcd1-4bda-862e-463b0c73faa9"
            },
            {
                platform: "Cantina",
                name: "Monad",
                maxBounty: "$1,000,000",
                languages: ["Rust", "C/C++"],
                categories: ["L1"],
                difficulty: "Advanced",
                url: "https://cantina.xyz/bounties/31f19cea-dda2-4568-8f99-27dafd120c97"
            },
            {
                platform: "Cantina",
                name: "Ventuals",
                maxBounty: "$1,000,000",
                languages: ["Solidity"],
                categories: ["Liquid Staking"],
                difficulty: "Intermediate",
                url: "https://cantina.xyz/bounties/d1c3592e-f335-4235-94ac-c6bf6cdb50a3"
            },
            {
                platform: "Cantina",
                name: "Agglayer/Polygon",
                maxBounty: "$1,000,000",
                languages: ["Rust", "Solidity"],
                categories: ["L2", "Bridge"],
                difficulty: "Advanced",
                url: "https://cantina.xyz/bounties/3aaad22b-52ee-4bb2-bed2-4be53b0993cc"
            },
            {
                platform: "Cantina",
                name: "PancakeSwap",
                maxBounty: "$1,000,000",
                languages: ["Solidity"],
                categories: ["DEX", "AMM"],
                difficulty: "Advanced",
                url: "https://cantina.xyz/bounties/ea552420-8bd6-4119-815d-3d5203d0377a"
            }
        ];

        // Languages and Categories - COMPLETE LIST
        const LANGUAGES = [
            'Solidity', 'Rust', 'Go', 'TypeScript', 'Move', 
            'C/C++', 'JavaScript', 'Python', 'CosmWasm'
        ];

        const CATEGORIES = [
            'AMM', 'Asset Management', 'Bridge', 'CDP', 'CEX', 'DAO', 
            'Derivatives', 'DEX', 'DEX Aggregator', 'Gaming', 'Insurance',
            'L1', 'L2', 'Launchpad', 'Lending', 'Liquid Staking',
            'NFT Marketplace', 'Oracle', 'Perpetuals', 'Stablecoin',
            'Synthetic Assets', 'Wallet', 'Yield Aggregator', 'Zero-Knowledge Proofs'
        ];

        // State
        let currentProfile = null;

        // Navigation
        function showLanding() {
            document.getElementById('landing-page').classList.remove('hidden');
            document.getElementById('profile-connect').classList.add('hidden');
            document.getElementById('loading-state').classList.add('hidden');
            document.getElementById('results-page').classList.add('hidden');
            document.getElementById('manual-skills').classList.add('hidden');
        }

        function showProfileConnect() {
            document.getElementById('landing-page').classList.add('hidden');
            document.getElementById('profile-connect').classList.remove('hidden');
            document.getElementById('loading-state').classList.add('hidden');
            document.getElementById('results-page').classList.add('hidden');
            document.getElementById('manual-skills').classList.add('hidden');
        }

        function showLoading() {
            document.getElementById('landing-page').classList.add('hidden');
            document.getElementById('profile-connect').classList.add('hidden');
            document.getElementById('loading-state').classList.remove('hidden');
            document.getElementById('results-page').classList.add('hidden');
            document.getElementById('manual-skills').classList.add('hidden');
        }

        function showResults() {
            document.getElementById('landing-page').classList.add('hidden');
            document.getElementById('profile-connect').classList.add('hidden');
            document.getElementById('loading-state').classList.add('hidden');
            document.getElementById('results-page').classList.remove('hidden');
            document.getElementById('manual-skills').classList.add('hidden');
            window.scrollTo(0, 0);
        }

        function showManualSkills() {
            document.getElementById('landing-page').classList.add('hidden');
            document.getElementById('profile-connect').classList.add('hidden');
            document.getElementById('loading-state').classList.add('hidden');
            document.getElementById('results-page').classList.add('hidden');
            document.getElementById('manual-skills').classList.remove('hidden');
            initializeManualSkills();
        }

        // Test profiles data (for MVP without backend)
        const TEST_PROFILES = {
            haxatron: {
                immunefi: {
                    username: 'Haxatron',
                    earnings: 154408,
                    rank: 130,
                    findings: {
                        bbp: { critical: 0, high: 0, medium: 2, low: 0 },
                        audit_comps: { critical: 1, high: 0, medium: 1, low: 0, insights: 1 }
                    },
                    competitions: [
                        { name: 'VeChain Hayabusa Upgrade', reward: 88174 },
                        { name: 'Puffer Finance', reward: 240 }
                    ]
                },
                cantina: {
                    username: 'Haxatron',
                    earnings: 656891,
                    rank: 2,
                    findings: 133,
                    competitions: [
                        { name: 'Omni Network Cross-chain L1 Cosmos SDK Solidity Rust', reward: 230532 },
                        { name: 'Story Protocol L1 Cosmos SDK Solidity', reward: 81021 },
                        { name: 'Optimism Fault Proofs L2 OP Stack Solidity', reward: 92970 },
                        { name: 'Berachain Beacon-Kit L1 Cosmos SDK', reward: 89779 },
                        { name: 'Blast L2 OP Stack Solidity', reward: 49659 },
                        { name: 'Dango DEX CosmWasm Rust AMM', reward: 20415 },
                        { name: 'Ark NFT Bridge Cairo Solidity Bridge', reward: 3153 }
                    ]
                }
            },
            blockian: {
                immunefi: {
                    username: 'Blockian',
                    earnings: 870178,
                    rank: 20,
                    findings: {
                        bbp: { critical: 3, high: 7, medium: 4, low: 7 },
                        audit_comps: { critical: 19, high: 11, medium: 2, low: 5, insights: 13 }
                    },
                    competitions: [
                        { name: 'Shardeum Core III L1 JavaScript', reward: 94767 },
                        { name: 'Fuel Network Rust L1', reward: 70876 },
                        { name: 'Shardeum Ancillaries III', reward: 49315 },
                        { name: 'Movement Labs Move L1', reward: 16675 }
                    ]
                },
                cantina: {
                    username: 'Blockian',
                    earnings: 5465,
                    rank: 323,
                    findings: 1,
                    competitions: [
                        { name: 'Euler v2 Lending Solidity', reward: 5072 }
                    ]
                }
            },
            br0nz3p1ck4x3: {
                immunefi: {
                    username: 'br0nz3p1ck4x3',
                    earnings: 158030,
                    rank: 94,
                    findings: {
                        bbp: { critical: 2, high: 2, medium: 1, low: 1 },
                        audit_comps: { critical: 2, high: 0, medium: 0, low: 0, insights: 5 }
                    },
                    competitions: [
                        { name: 'Movement Labs Move L1', reward: 13713 },
                        { name: 'Ethereum Protocol L1 Consensus Solidity', reward: 4369 },
                        { name: 'Shardeum Ancillaries III JavaScript', reward: 500 }
                    ]
                },
                cantina: null
            },
            dontonka: {
                immunefi: {
                    username: 'dontonka',
                    earnings: 14138,
                    rank: 421,
                    findings: {
                        bbp: { critical: 0, high: 0, medium: 1, low: 0 },
                        audit_comps: { critical: 1, high: 1, medium: 1, low: 0, insights: 3 }
                    },
                    competitions: [
                        { name: 'ZeroLend Lending Solidity', reward: 5000 },
                        { name: 'DeGate DEX Solidity', reward: 4000 },
                        { name: 'Puffer Finance Staking Solidity', reward: 3000 }
                    ]
                },
                cantina: {
                    username: 'dontonka',
                    earnings: 408490,
                    rank: 5,
                    findings: 77,
                    competitions: [
                        { name: 'Omni Network Cross-chain L1 Cosmos SDK Go Solidity', reward: 124991 },
                        { name: 'Story Protocol L1 Cosmos SDK Go', reward: 45207 },
                        { name: 'Blast L2 OP Stack Solidity', reward: 43405 },
                        { name: 'Ronin Network L1 Go Gaming', reward: 30000 },
                        { name: 'Berachain Beacon-Kit L1 Cosmos SDK Go', reward: 25000 },
                        { name: 'Bitcoin Staking Scripts', reward: 10754 },
                        { name: 'ZetaChain L1 Cosmos SDK Go', reward: 3235 }
                    ]
                }
            }
        };

        // Profile Analysis with TEST DATA (avoids CORS issues)
        async function analyzeProfiles() {
            const immunefiUsername = document.getElementById('immunefiUsername').value.trim().toLowerCase();
            const cantinaUsername = document.getElementById('cantinaUsername').value.trim().toLowerCase();

            if (!immunefiUsername && !cantinaUsername) {
                alert('Please enter at least one username');
                return;
            }

            showLoading();

            // Simulate loading delay
            await new Promise(resolve => setTimeout(resolve, 1500));

            // Check test data
            const profileData = TEST_PROFILES[immunefiUsername] || TEST_PROFILES[cantinaUsername];

            if (!profileData) {
                alert(`Profile not found in demo database. Try one of these usernames:\n\n• haxatron\n• blockian\n• br0nz3p1ck4x3\n• dontonka\n\nNote: Live scraping requires a backend API (CORS restriction). This MVP uses test data.`);
                showProfileConnect();
                return;
            }

            currentProfile = aggregateProfile(profileData);
            displayResults(currentProfile);
            showResults();
        }

        function aggregateProfile(rawProfile) {
            const aggregated = {
                platforms_active: [],
                total_earnings: 0,
                total_findings: 0,
                findings_by_severity: {
                    critical: 0,
                    high: 0,
                    medium: 0,
                    low: 0,
                    insights: 0
                },
                competitions: [],
                skills: {
                    languages: new Set(),
                    categories: new Set(),
                    specializations: new Set()
                },
                immunefi_username: rawProfile.immunefi?.username || null,
                cantina_username: rawProfile.cantina?.username || null
            };

            // Aggregate Immunefi
            if (rawProfile.immunefi) {
                aggregated.platforms_active.push('Immunefi');
                aggregated.total_earnings += rawProfile.immunefi.earnings;
                
                const immunefiFindings = rawProfile.immunefi.findings;
                aggregated.findings_by_severity.critical += (immunefiFindings.bbp?.critical || 0) + (immunefiFindings.audit_comps?.critical || 0);
                aggregated.findings_by_severity.high += (immunefiFindings.bbp?.high || 0) + (immunefiFindings.audit_comps?.high || 0);
                aggregated.findings_by_severity.medium += (immunefiFindings.bbp?.medium || 0) + (immunefiFindings.audit_comps?.medium || 0);
                aggregated.findings_by_severity.low += (immunefiFindings.bbp?.low || 0) + (immunefiFindings.audit_comps?.low || 0);
                aggregated.findings_by_severity.insights += immunefiFindings.audit_comps?.insights || 0;
                
                aggregated.immunefi_rank = rawProfile.immunefi.rank;
                aggregated.competitions.push(...(rawProfile.immunefi.competitions || []));
            }

            // Aggregate Cantina
            if (rawProfile.cantina) {
                aggregated.platforms_active.push('Cantina');
                aggregated.total_earnings += rawProfile.cantina.earnings;
                aggregated.total_findings += rawProfile.cantina.findings || 0;
                aggregated.cantina_rank = rawProfile.cantina.rank;
                aggregated.competitions.push(...(rawProfile.cantina.competitions || []));
            }

            // Calculate total findings
            aggregated.total_findings += Object.values(aggregated.findings_by_severity).reduce((a, b) => a + b, 0);

            // Detect seniority (EARNINGS FIRST)
            aggregated.seniority = detectSeniority(aggregated);

            // Infer skills from competitions
            aggregated.skills = inferSkills(aggregated.competitions);

            return aggregated;
        }

        function inferSkills(competitions) {
            const skills = {
                languages: new Set(),
                categories: new Set(),
                specializations: new Set()
            };

            for (const comp of competitions) {
                const text = (comp.name || '').toLowerCase();

                // Languages
                if (text.includes('solidity')) skills.languages.add('Solidity');
                if (text.includes('rust')) skills.languages.add('Rust');
                if (text.includes('cairo')) skills.languages.add('Cairo');
                if (text.includes('cosmwasm') || text.includes('cosmos')) skills.languages.add('CosmWasm');
                if (text.includes('move')) skills.languages.add('Move');
                if (text.includes('javascript') || text.includes('typescript')) skills.languages.add('JavaScript');
                if (text.includes('go')) skills.languages.add('Go');
                if (text.includes('c++') || text.includes('cpp')) skills.languages.add('C/C++');

                // Categories
                if (text.includes('dex') || text.includes('amm')) skills.categories.add('DEX');
                if (text.includes('lending')) skills.categories.add('Lending');
                if (text.includes('staking')) skills.categories.add('Staking');
                if (text.includes('dao')) skills.categories.add('DAO');
                if (text.includes('yield')) skills.categories.add('Yield Aggregator');
                if (text.includes('bridge')) skills.categories.add('Bridge');
                if (text.includes('l1') || text.includes('layer 1')) skills.categories.add('L1');
                if (text.includes('l2') || text.includes('layer 2') || text.includes('op stack')) skills.categories.add('L2');
                if (text.includes('nft')) skills.categories.add('NFT Marketplace');
                if (text.includes('perpetual') || text.includes('perp')) skills.categories.add('Perpetuals');
                if (text.includes('liquid staking')) skills.categories.add('Liquid Staking');
            }

            return {
                languages: Array.from(skills.languages),
                categories: Array.from(skills.categories),
                specializations: Array.from(skills.specializations)
            };
        }

        function detectSeniority(profile) {
            const earnings = profile.total_earnings;
            const criticals = profile.findings_by_severity.critical;
            
            // EARNINGS FIRST - Primary signal
            if (earnings >= 50000) {
                return {
                    level: 'ADVANCED',
                    confidence: 99,
                    reasoning: `Total earnings: $${earnings.toLocaleString()}`
                };
            }

            if (earnings >= 5000 && earnings < 50000) {
                return {
                    level: 'INTERMEDIATE',
                    confidence: 95,
                    reasoning: `Total earnings: $${earnings.toLocaleString()}`
                };
            }

            if (criticals >= 3 && earnings >= 20000) {
                return {
                    level: 'ADVANCED',
                    confidence: 90,
                    reasoning: `${criticals} Critical findings + $${earnings.toLocaleString()}`
                };
            }

            // Default to Novice
            return {
                level: 'NOVICE',
                confidence: 80,
                reasoning: `Total earnings: $${earnings.toLocaleString()}`
            };
        }

        // Display results - UPDATED UI
        function displayResults(profile) {
            // Determine display username (alphabetical priority if different on platforms)
            let displayUsername = 'Researcher';
            
            const immunefiUser = profile.immunefi_username;
            const cantinaUser = profile.cantina_username;
            
            if (immunefiUser && cantinaUser && immunefiUser.toLowerCase() !== cantinaUser.toLowerCase()) {
                // Both exist and different - pick alphabetically first
                displayUsername = immunefiUser.toLowerCase() < cantinaUser.toLowerCase() ? immunefiUser : cantinaUser;
            } else {
                // Same username or only one exists
                displayUsername = immunefiUser || cantinaUser || 'Researcher';
            }

            const summaryHTML = `
                <!-- Username Display -->
                <div class="mb-6">
                    <h2 class="text-2xl font-semibold text-gray-700">Viewing profile: <span class="gradient-text">${displayUsername}</span></h2>
                </div>

                <!-- Seniority Badge and Earnings - CENTERED -->
                <div class="text-center mb-10">
                    <div class="inline-flex items-center gap-3 mb-4">
                        <span class="badge-${profile.seniority.level.toLowerCase()} text-white px-6 py-3 rounded-full text-lg font-bold">
                            ${profile.seniority.level}
                        </span>
                    </div>
                    <div class="mb-2">
                        <div class="text-6xl font-bold gradient-text">$${profile.total_earnings.toLocaleString()}</div>
                        <div class="text-xl text-gray-600 mt-2">Total Earnings</div>
                    </div>
                    <p class="text-gray-600 mt-4">${profile.seniority.reasoning}</p>
                </div>
                <div class="grid md:grid-cols-2 gap-6 mb-8">
                    <!-- Platforms -->
                    <div class="bg-gradient-to-br from-purple-50 to-purple-100 p-6 rounded-2xl border-2 border-purple-200">
                        <div class="text-3xl font-bold text-purple-600">${profile.platforms_active.length}</div>
                        <div class="text-gray-700 font-semibold mb-3">Platforms Active</div>
                        <div class="space-y-2">
                            ${profile.platforms_active.map(p => `
                                <div class="flex items-center gap-2">
                                    <svg class="w-5 h-5 text-purple-600" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg>
                                    <span class="font-semibold">${p}</span>
                                    ${p === 'Immunefi' && profile.immunefi_rank ? `<span class="text-sm text-gray-600">(Rank: ${profile.immunefi_rank})</span>` : ''}
                                    ${p === 'Cantina' && profile.cantina_rank ? `<span class="text-sm text-gray-600">(Rank: ${profile.cantina_rank})</span>` : ''}
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- Findings Summary Table -->
                    <div class="bg-gradient-to-br from-sky-50 to-sky-100 p-6 rounded-2xl border-2 border-sky-200">
                        <div class="text-3xl font-bold text-sky-600 mb-3">${profile.total_findings}</div>
                        <div class="text-gray-700 font-semibold mb-4">Total Findings</div>
                        <div class="space-y-2">
                            ${profile.findings_by_severity.critical > 0 ? `
                                <div class="flex justify-between items-center bg-red-100 px-3 py-2 rounded-lg">
                                    <span class="font-semibold text-red-700">Critical</span>
                                    <span class="font-bold text-red-700">${profile.findings_by_severity.critical}</span>
                                </div>
                            ` : ''}
                            ${profile.findings_by_severity.high > 0 ? `
                                <div class="flex justify-between items-center bg-orange-100 px-3 py-2 rounded-lg">
                                    <span class="font-semibold text-orange-700">High</span>
                                    <span class="font-bold text-orange-700">${profile.findings_by_severity.high}</span>
                                </div>
                            ` : ''}
                            ${profile.findings_by_severity.medium > 0 ? `
                                <div class="flex justify-between items-center bg-yellow-100 px-3 py-2 rounded-lg">
                                    <span class="font-semibold text-yellow-700">Medium</span>
                                    <span class="font-bold text-yellow-700">${profile.findings_by_severity.medium}</span>
                                </div>
                            ` : ''}
                            ${profile.findings_by_severity.low > 0 ? `
                                <div class="flex justify-between items-center bg-gray-100 px-3 py-2 rounded-lg">
                                    <span class="font-semibold text-gray-700">Low</span>
                                    <span class="font-bold text-gray-700">${profile.findings_by_severity.low}</span>
                                </div>
                            ` : ''}
                            ${profile.findings_by_severity.insights > 0 ? `
                                <div class="flex justify-between items-center bg-blue-100 px-3 py-2 rounded-lg">
                                    <span class="font-semibold text-blue-700">Insights</span>
                                    <span class="font-bold text-blue-700">${profile.findings_by_severity.insights}</span>
                                </div>
                            ` : ''}
                        </div>
                        ${profile.cantina_rank ? `
                            <div class="mt-3 p-2 bg-purple-50 rounded-lg border border-purple-200">
                                <p class="text-xs text-purple-700">
                                    <span class="font-semibold">Note:</span> Cantina severity breakdown in development. Currently showing Immunefi severities only.
                                </p>
                            </div>
                        ` : ''}
                    </div>
                </div>

                <!-- Editable Skills Section -->
                <div class="bg-gradient-to-br from-indigo-50 to-indigo-100 p-6 rounded-2xl border-2 border-indigo-200 mb-6">
                    <div class="flex justify-between items-center mb-4">
                        <h4 class="font-bold text-lg text-gray-800">Your Tech Stack & Expertise</h4>
                        <button onclick="editSkills()" class="text-sm bg-white hover:bg-gray-50 text-indigo-600 font-semibold px-4 py-2 rounded-lg border-2 border-indigo-300 transition-all">
                            ✏️ Edit Skills
                        </button>
                    </div>
                    <div id="skills-display">
                        ${profile.skills.languages.length > 0 ? `
                            <div class="mb-4">
                                <div class="text-sm text-gray-600 mb-2">LANGUAGES:</div>
                                <div class="flex flex-wrap gap-2">
                                    ${profile.skills.languages.map(lang => `
                                        <span class="bg-white px-3 py-1 rounded-full text-sm font-semibold text-gray-700 border border-indigo-300">${lang}</span>
                                    `).join('')}
                                </div>
                            </div>
                        ` : '<p class="text-gray-600 text-sm">Click "Edit Skills" to add your languages and expertise areas</p>'}
                        ${profile.skills.categories.length > 0 || profile.skills.specializations.length > 0 ? `
                            <div>
                                <div class="text-sm text-gray-600 mb-2">EXPERTISE:</div>
                                <div class="flex flex-wrap gap-2">
                                    ${[...profile.skills.categories, ...profile.skills.specializations].map(cat => `
                                        <span class="bg-white px-3 py-1 rounded-full text-sm font-semibold text-gray-700 border border-indigo-300">${cat}</span>
                                    `).join('')}
                                </div>
                            </div>
                        ` : ''}
                    </div>
                </div>
            `;
            document.getElementById('profile-summary').innerHTML = summaryHTML;

            // Generate recommendations
            const recommendations = generateRecommendations(profile);
            displayRecommendations(recommendations);
        }

        // Edit skills modal/inline
        function editSkills() {
            const modal = `
                <div class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4" onclick="if(event.target===this) closeSkillsModal()">
                    <div class="bg-white rounded-3xl shadow-2xl p-8 max-w-4xl w-full max-h-[90vh] overflow-y-auto" onclick="event.stopPropagation()">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-2xl font-bold gradient-text">Edit Your Skills</h3>
                            <button onclick="closeSkillsModal()" class="text-gray-500 hover:text-gray-700">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                        
                        <div class="mb-6">
                            <h4 class="font-bold text-lg mb-3">Language Proficiency</h4>
                            <p class="text-sm text-gray-600 mb-4">Rate your confidence: 1 = Novice, 5 = Expert</p>
                            <div class="space-y-4" id="modal-languages">
                                ${LANGUAGES.map(lang => {
                                    const currentLevel = currentProfile.skills.languages.includes(lang) ? 3 : 0;
                                    return `
                                        <div class="bg-gray-50 p-4 rounded-xl">
                                            <div class="flex justify-between items-center mb-2">
                                                <span class="font-semibold text-gray-800">${lang}</span>
                                                <span class="text-sm font-bold text-sky-600" id="modal-lang-${lang.replace(/[^a-zA-Z]/g,'')}-value">${currentLevel}</span>
                                            </div>
                                            <input type="range" min="0" max="5" value="${currentLevel}" class="slider w-full modal-lang-slider" 
                                                   data-lang="${lang}" 
                                                   oninput="document.getElementById('modal-lang-${lang.replace(/[^a-zA-Z]/g,'')}-value').textContent = this.value">
                                            <div class="flex justify-between text-xs text-gray-500 mt-1">
                                                <span>None</span>
                                                <span>Novice</span>
                                                <span>Intermediate</span>
                                                <span>Advanced</span>
                                                <span>Expert</span>
                                            </div>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>

                        <div class="mb-6">
                            <h4 class="font-bold text-lg mb-3">Product Categories</h4>
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-2" id="modal-categories">
                                ${CATEGORIES.map(cat => `
                                    <label class="flex items-center bg-gray-50 p-2 rounded-lg cursor-pointer hover:bg-gray-100">
                                        <input type="checkbox" value="${cat}" class="mr-2 modal-cat" ${currentProfile.skills.categories.includes(cat) || currentProfile.skills.specializations.includes(cat) ? 'checked' : ''}>
                                        <span class="text-sm font-semibold">${cat}</span>
                                    </label>
                                `).join('')}
                            </div>
                        </div>

                        <button onclick="saveSkills()" class="w-full bg-gradient-to-r from-sky-500 to-purple-600 hover:from-sky-600 hover:to-purple-700 text-white font-bold px-6 py-3 rounded-xl transition-all">
                            Save Changes
                        </button>
                    </div>
                </div>
            `;
            
            const modalDiv = document.createElement('div');
            modalDiv.id = 'skills-modal';
            modalDiv.innerHTML = modal;
            document.body.appendChild(modalDiv);
        }

        function closeSkillsModal() {
            const modal = document.getElementById('skills-modal');
            if (modal) modal.remove();
        }

        function saveSkills() {
            // Get languages with proficiency >= 1
            const langSliders = document.querySelectorAll('.modal-lang-slider');
            const selectedLangs = Array.from(langSliders)
                .filter(slider => parseInt(slider.value) >= 1)
                .map(slider => slider.dataset.lang);
            
            const selectedCats = Array.from(document.querySelectorAll('.modal-cat:checked')).map(el => el.value);
            
            currentProfile.skills.languages = selectedLangs;
            currentProfile.skills.categories = selectedCats;
            currentProfile.skills.specializations = [];
            
            closeSkillsModal();
            displayResults(currentProfile);
        }

        // Matching algorithm
        function generateRecommendations(profile) {
            const scored = PROGRAMS.map(program => {
                let score = 0;
                let reasons = [];

                // Language match (60 points per match - PRIMARY)
                const langMatches = program.languages.filter(lang => 
                    profile.skills.languages.some(userLang => userLang.includes(lang) || lang.includes(userLang))
                );
                if (langMatches.length > 0) {
                    score += langMatches.length * 60;
                    reasons.push(`Matches your ${langMatches.join(', ')} skills`);
                }

                // Category match (25 points per match)
                const catMatches = program.categories.filter(cat => 
                    profile.skills.categories.includes(cat) || 
                    profile.skills.specializations.some(spec => spec.includes(cat) || cat.includes(spec))
                );
                if (catMatches.length > 0) {
                    score += catMatches.length * 25;
                    reasons.push(`Expertise in ${catMatches.join(', ')}`);
                }

                // Experience level match (30 points bonus, penalties for mismatch)
                const userLevel = profile.seniority.level;
                const programLevel = program.difficulty;
                
                if (userLevel === programLevel) {
                    score += 30;
                    reasons.push(`Perfect experience match (${programLevel})`);
                } else if (userLevel === 'NOVICE' && programLevel === 'Advanced') {
                    score -= 40;
                } else if (userLevel === 'INTERMEDIATE' && programLevel === 'Advanced') {
                    score -= 15;
                } else if (userLevel === 'ADVANCED' && programLevel === 'Beginner') {
                    score -= 10;
                }

                return { ...program, score, matchReasons: reasons };
            });

            // Filter out programs with score < 20 (no meaningful match)
            const filtered = scored.filter(p => p.score >= 20);

            // Sort by score descending
            filtered.sort((a, b) => b.score - a.score);

            return filtered.slice(0, 10); // Top 10
        }

        function displayRecommendations(programs) {
            const html = programs.map((program, index) => `
                <div class="bg-white/90 backdrop-blur-sm rounded-2xl shadow-lg p-6 border-2 ${
                    index === 0 ? 'border-yellow-400' : 
                    index === 1 ? 'border-gray-300' : 
                    index === 2 ? 'border-orange-400' : 
                    'border-sky-200'
                } card-hover">
                    ${index < 3 ? `
                        <div class="inline-block mb-3">
                            <span class="bg-gradient-to-r ${
                                index === 0 ? 'from-yellow-400 to-yellow-600' : 
                                index === 1 ? 'from-gray-400 to-gray-600' : 
                                'from-orange-400 to-orange-600'
                            } text-white px-3 py-1 rounded-full text-xs font-bold">
                                ${index === 0 ? '🥇 BEST MATCH' : index === 1 ? '🥈 GREAT FIT' : '🥉 SOLID CHOICE'}
                            </span>
                        </div>
                    ` : ''}
                    
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h3 class="text-2xl font-bold text-gray-800 mb-1">${program.name}</h3>
                            <span class="inline-block px-3 py-1 rounded-full text-xs font-semibold ${
                                program.platform === 'Immunefi' ? 'bg-sky-100 text-sky-700' : 'bg-purple-100 text-purple-700'
                            }">
                                ${program.platform}
                            </span>
                        </div>
                        <div class="text-right">
                            <div class="text-2xl font-bold text-green-600">${program.maxBounty}</div>
                            <div class="text-xs text-gray-500">Max Bounty</div>
                        </div>
                    </div>

                    ${program.description ? `<p class="text-gray-600 mb-4 text-sm">${program.description}</p>` : ''}

                    <!-- Why this fits you -->
                    ${program.matchReasons && program.matchReasons.length > 0 ? `
                        <div class="mb-4 p-3 bg-green-50 rounded-lg border-2 border-green-200">
                            <div class="text-xs font-bold text-green-700 mb-1">WHY THIS FITS YOU:</div>
                            <div class="text-sm text-green-700">
                                ${program.matchReasons.join(' • ')}
                            </div>
                        </div>
                    ` : ''}

                    <div class="mb-4">
                        <div class="text-xs text-gray-500 mb-2">TECH STACK</div>
                        <div class="flex flex-wrap gap-2">
                            ${program.languages.map(lang => `
                                <span class="bg-indigo-100 text-indigo-700 px-2 py-1 rounded text-xs font-semibold">${lang}</span>
                            `).join('')}
                        </div>
                    </div>

                    <div class="mb-4">
                        <div class="text-xs text-gray-500 mb-2">CATEGORIES</div>
                        <div class="flex flex-wrap gap-2">
                            ${program.categories.map(cat => `
                                <span class="bg-pink-100 text-pink-700 px-2 py-1 rounded text-xs font-semibold">${cat}</span>
                            `).join('')}
                        </div>
                    </div>

                    <div class="flex justify-between items-center pt-4 border-t border-gray-200">
                        <span class="text-sm ${
                            program.difficulty === 'Advanced' ? 'text-red-600' :
                            program.difficulty === 'Intermediate' ? 'text-orange-600' :
                            'text-green-600'
                        } font-semibold">
                            ${program.difficulty}
                        </span>
                        <a href="${program.url}" target="_blank" class="bg-gradient-to-r from-sky-500 to-purple-600 hover:from-sky-600 hover:to-purple-700 text-white font-bold px-6 py-2 rounded-lg text-sm transition-all transform hover:scale-105">
                            View Program →
                        </a>
                    </div>
                </div>
            `).join('');

            document.getElementById('recommendations-grid').innerHTML = html;
        }

        // Manual skills entry
        function initializeManualSkills() {
            // Languages with sliders
            const langHTML = LANGUAGES.map(lang => `
                <div class="bg-white p-4 rounded-xl border-2 border-gray-200">
                    <div class="flex justify-between items-center mb-2">
                        <span class="font-semibold text-gray-800">${lang}</span>
                        <span class="text-sm font-bold text-sky-600" id="lang-${lang.replace(/[^a-zA-Z]/g,'')}-value">3</span>
                    </div>
                    <input type="range" min="1" max="5" value="3" class="slider w-full manual-lang-slider" 
                           data-lang="${lang}" 
                           oninput="document.getElementById('lang-${lang.replace(/[^a-zA-Z]/g,'')}-value').textContent = this.value">
                    <div class="flex justify-between text-xs text-gray-500 mt-1">
                        <span>Novice</span>
                        <span>Expert</span>
                    </div>
                </div>
            `).join('');
            document.getElementById('manual-languages').innerHTML = langHTML;

            // Categories
            const catHTML = CATEGORIES.map(cat => `
                <label class="flex items-center bg-white p-3 rounded-xl border-2 border-gray-300 cursor-pointer hover:border-purple-500 transition-all">
                    <input type="checkbox" value="${cat}" class="mr-2 manual-cat">
                    <span class="font-semibold text-gray-700 text-sm">${cat}</span>
                </label>
            `).join('');
            document.getElementById('manual-categories').innerHTML = catHTML;

            // Experience levels
            const expHTML = `
                <label class="flex items-center space-x-3 cursor-pointer bg-white p-4 rounded-xl border-2 border-gray-300 hover:border-purple-400 transition-all">
                    <input type="radio" name="experience" value="NOVICE" class="text-purple-600">
                    <div>
                        <div class="font-bold text-gray-800">Novice</div>
                        <div class="text-sm text-gray-600">New to bug hunting, learning the basics</div>
                    </div>
                </label>
                <label class="flex items-center space-x-3 cursor-pointer bg-white p-4 rounded-xl border-2 border-gray-300 hover:border-purple-400 transition-all">
                    <input type="radio" name="experience" value="INTERMEDIATE" checked class="text-purple-600">
                    <div>
                        <div class="font-bold text-gray-800">Intermediate</div>
                        <div class="text-sm text-gray-600">Found some bugs, familiar with common vulnerabilities</div>
                    </div>
                </label>
                <label class="flex items-center space-x-3 cursor-pointer bg-white p-4 rounded-xl border-2 border-gray-300 hover:border-purple-400 transition-all">
                    <input type="radio" name="experience" value="ADVANCED" class="text-purple-600">
                    <div>
                        <div class="font-bold text-gray-800">Advanced</div>
                        <div class="text-sm text-gray-600">Experienced researcher with multiple successful reports</div>
                    </div>
                </label>
            `;
            document.getElementById('manual-experience').innerHTML = expHTML;
        }

        function generateManualRecommendations() {
            // Get languages with proficiency >= 3
            const langSliders = document.querySelectorAll('.manual-lang-slider');
            const selectedLangs = Array.from(langSliders)
                .filter(slider => parseInt(slider.value) >= 3)
                .map(slider => slider.dataset.lang);

            const selectedCats = Array.from(document.querySelectorAll('.manual-cat:checked')).map(el => el.value);
            const selectedExp = document.querySelector('input[name="experience"]:checked')?.value || 'INTERMEDIATE';

            if (selectedLangs.length === 0) {
                alert('Please rate at least one language with 3+ proficiency');
                return;
            }

            const manualProfile = {
                seniority: {
                    level: selectedExp,
                    confidence: 80,
                    reasoning: 'Based on self-reported experience level'
                },
                skills: {
                    languages: selectedLangs,
                    categories: selectedCats,
                    specializations: []
                },
                total_earnings: 0,
                total_findings: 0,
                findings_by_severity: { critical: 0, high: 0, medium: 0, low: 0, insights: 0 },
                platforms_active: ['Manual Entry']
            };

            currentProfile = manualProfile;
            displayResults(manualProfile);
            showResults();
        }
    </script>
</body>
</html>
a name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PanoptesHQ - AI-Powered Bug Bounty Recommendations</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 50%, #fef3c7 100%);
            min-height: 100vh;
        }
        .gradient-text {
            background: linear-gradient(135deg, #0ea5e9 0%, #8b5cf6 50%, #ec4899 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgba(14, 165, 233, 0.2);
        }
        .badge-advanced {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        .badge-intermediate {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }
        .badge-novice {
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
        }
        .slider {
            -webkit-appearance: none;
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: #e5e7eb;
            outline: none;
        }
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #0ea5e9;
            cursor: pointer;
        }
        .slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #0ea5e9;
            cursor: pointer;
            border: none;
        }
    </style>
</head>
<body class="text-gray-900">
    
    <!-- Landing Page -->
    <div id="landing-page" class="min-h-screen flex items-center justify-center px-4">
        <div class="max-w-5xl w-full text-center">
            <h1 class="text-6xl md:text-7xl font-bold mb-6">
                <span class="gradient-text">PanoptesHQ</span>
            </h1>
            <p class="text-3xl md:text-4xl text-gray-700 font-semibold mb-4">
                Stop choosing where to hunt
            </p>
            <p class="text-xl text-gray-600 mb-12 max-w-2xl mx-auto">
                Connect your bug bounty profiles and get AI-powered recommendations tailored to your skills and experience
            </p>
            
            <div class="grid md:grid-cols-3 gap-6 mb-12">
                <div class="bg-white/80 backdrop-blur-sm p-8 rounded-2xl shadow-lg border-2 border-sky-200">
                    <div class="w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-sky-400 to-sky-600 rounded-2xl flex items-center justify-center">
                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-bold mb-3 text-gray-800">Auto-Profile Sync</h3>
                    <p class="text-gray-600">Connect Immunefi & Cantina to auto-detect your skills, experience level, and expertise areas</p>
                </div>
                <div class="bg-white/80 backdrop-blur-sm p-8 rounded-2xl shadow-lg border-2 border-purple-200">
                    <div class="w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-purple-400 to-purple-600 rounded-2xl flex items-center justify-center">
                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-bold mb-3 text-gray-800">Smart Matching</h3>
                    <p class="text-gray-600">Get personalized program recommendations based on your tech stack and proven track record</p>
                </div>
                <div class="bg-white/80 backdrop-blur-sm p-8 rounded-2xl shadow-lg border-2 border-pink-200">
                    <div class="w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-pink-400 to-pink-600 rounded-2xl flex items-center justify-center">
                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-bold mb-3 text-gray-800">Maximize Earnings</h3>
                    <p class="text-gray-600">Hunt programs that match your strengths from both Immunefi and Cantina platforms</p>
                </div>
            </div>
            
            <button onclick="showProfileConnect()" class="bg-gradient-to-r from-sky-500 to-purple-600 hover:from-sky-600 hover:to-purple-700 text-white font-bold px-12 py-5 rounded-2xl text-xl transition-all transform hover:scale-105 shadow-xl">
                Connect Profiles →
            </button>
            
            <p class="text-gray-500 mt-6">Free • 2 minutes • No signup required</p>
        </div>
    </div>

    <!-- Profile Connection -->
    <div id="profile-connect" class="hidden min-h-screen py-16 px-4">
        <div class="max-w-2xl mx-auto">
            <button onclick="showLanding()" class="text-sky-600 hover:text-sky-700 font-semibold mb-6">← Back</button>
            
            <div class="bg-white/90 backdrop-blur-sm rounded-3xl shadow-2xl p-10 border-2 border-sky-100">
                <h2 class="text-4xl font-bold mb-3 gradient-text">Connect Your Profiles</h2>
                <p class="text-gray-600 mb-10">We'll analyze your activity to personalize recommendations</p>

                <div class="space-y-6">
                    <!-- Immunefi -->
                    <div>
                        <label class="block text-lg font-semibold text-gray-800 mb-3">
                            <span class="inline-flex items-center">
                                <svg class="w-6 h-6 mr-2 text-sky-600" fill="currentColor" viewBox="0 0 20 20"><path d="M10 2a8 8 0 100 16 8 8 0 000-16zm0 14a6 6 0 110-12 6 6 0 010 12z"/></svg>
                                Immunefi Username
                            </span>
                        </label>
                        <input 
                            type="text" 
                            id="immunefiUsername" 
                            class="w-full bg-white border-2 border-gray-300 rounded-xl px-6 py-4 text-gray-900 focus:outline-none focus:border-sky-500 text-lg"
                            placeholder="e.g., Haxatron"
                        >
                        <p class="text-sm text-gray-500 mt-2">Find it at: immunefi.com/profile/[username]</p>
                    </div>

                    <!-- Cantina -->
                    <div>
                        <label class="block text-lg font-semibold text-gray-800 mb-3">
                            <span class="inline-flex items-center">
                                <svg class="w-6 h-6 mr-2 text-purple-600" fill="currentColor" viewBox="0 0 20 20"><path d="M10 2a8 8 0 100 16 8 8 0 000-16zm0 14a6 6 0 110-12 6 6 0 010 12z"/></svg>
                                Cantina Username (Optional)
                            </span>
                        </label>
                        <input 
                            type="text" 
                            id="cantinaUsername" 
                            class="w-full bg-white border-2 border-gray-300 rounded-xl px-6 py-4 text-gray-900 focus:outline-none focus:border-purple-500 text-lg"
                            placeholder="e.g., Haxatron"
                        >
                        <p class="text-sm text-gray-500 mt-2">Find it at: cantina.xyz/u/[username]</p>
                    </div>
                </div>

                <div class="mt-10 p-6 bg-sky-50 rounded-xl border-2 border-sky-200">
                    <p class="text-sm text-gray-700">
                        <span class="font-semibold">Note:</span> We'll fetch your public earnings, findings, and programs to recommend the best bounties for you. No login required.
                    </p>
                </div>

                <button 
                    onclick="analyzeProfiles()" 
                    class="w-full mt-8 bg-gradient-to-r from-sky-500 to-purple-600 hover:from-sky-600 hover:to-purple-700 text-white font-bold px-8 py-5 rounded-2xl text-xl transition-all transform hover:scale-105 shadow-lg"
                >
                    Analyze My Profiles →
                </button>

                <p class="text-center text-gray-500 mt-6">or</p>

                <button 
                    onclick="showManualSkills()" 
                    class="w-full mt-4 bg-white hover:bg-gray-50 text-gray-700 font-semibold px-8 py-4 rounded-2xl text-lg border-2 border-gray-300 transition-all"
                >
                    Enter Skills Manually
                </button>
            </div>
        </div>
    </div>

    <!-- Loading State -->
    <div id="loading-state" class="hidden min-h-screen flex items-center justify-center px-4">
        <div class="text-center">
            <div class="inline-block animate-spin rounded-full h-16 w-16 border-4 border-sky-500 border-t-transparent mb-6"></div>
            <h3 class="text-2xl font-bold text-gray-800 mb-2">Analyzing Your Profiles...</h3>
            <p class="text-gray-600" id="loading-message">Fetching data from Immunefi</p>
        </div>
    </div>

    <!-- Profile Results + Recommendations -->
    <div id="results-page" class="hidden min-h-screen py-16 px-4">
        <div class="max-w-6xl mx-auto">
            <button onclick="showProfileConnect()" class="text-sky-600 hover:text-sky-700 font-semibold mb-6">← Try Different Profiles</button>
            
            <!-- Aggregated Profile Card -->
            <div id="profile-summary" class="bg-white/90 backdrop-blur-sm rounded-3xl shadow-2xl p-10 mb-10 border-2 border-sky-100">
                <!-- Will be populated by JavaScript -->
            </div>

            <!-- Recommendations -->
            <div>
                <h2 class="text-3xl font-bold mb-6 gradient-text">Your Personalized Recommendations</h2>
                <p class="text-gray-600 mb-8">Based on your skills and experience, here are the top programs for you:</p>
                
                <div id="recommendations-grid" class="grid md:grid-cols-2 gap-6">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Manual Skills Entry (Fallback) -->
    <div id="manual-skills" class="hidden min-h-screen py-16 px-4">
        <div class="max-w-4xl mx-auto">
            <button onclick="showProfileConnect()" class="text-sky-600 hover:text-sky-700 font-semibold mb-6">← Back</button>
            
            <div class="bg-white/90 backdrop-blur-sm rounded-3xl shadow-2xl p-10 border-2 border-sky-100">
                <h2 class="text-4xl font-bold mb-3 gradient-text">Tell Us Your Skills</h2>
                <p class="text-gray-600 mb-10">Rate your proficiency in each language and select your expertise areas</p>

                <!-- Languages with Proficiency Levels -->
                <div class="mb-10">
                    <h3 class="text-2xl font-bold mb-6 text-gray-800">Language Proficiency</h3>
                    <p class="text-sm text-gray-600 mb-6">Rate your confidence: 1 = Novice, 5 = Expert</p>
                    <div class="space-y-6" id="manual-languages">
                        <!-- Will be populated -->
                    </div>
                </div>

                <!-- Product Categories -->
                <div class="mb-10">
                    <h3 class="text-2xl font-bold mb-6 text-gray-800">Product Expertise</h3>
                    <p class="text-sm text-gray-600 mb-6">Select all categories you're familiar with</p>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-3" id="manual-categories">
                        <!-- Will be populated -->
                    </div>
                </div>

                <!-- Experience Level -->
                <div class="mb-10">
                    <h3 class="text-2xl font-bold mb-6 text-gray-800">Experience Level</h3>
                    <div class="space-y-3" id="manual-experience">
                        <!-- Will be populated -->
                    </div>
                </div>

                <button 
                    onclick="generateManualRecommendations()" 
                    class="w-full bg-gradient-to-r from-sky-500 to-purple-600 hover:from-sky-600 hover:to-purple-700 text-white font-bold px-8 py-5 rounded-2xl text-xl transition-all transform hover:scale-105 shadow-lg"
                >
                    Get Recommendations →
                </button>
            </div>
        </div>
    </div>

    <script>
        // Program Database - UPDATED WITH CORRECT CANTINA LINKS
        const PROGRAMS = [
            // Immunefi Programs
            {
                platform: "Immunefi",
                name: "GMX",
                description: "Decentralized spot and perpetual exchange with low swap fees and zero price impact trades.",
                maxBounty: "$5,000,000",
                languages: ["Solidity", "JavaScript", "TypeScript"],
                categories: ["AMM", "DEX", "Perpetuals"],
                difficulty: "Advanced",
                url: "https://immunefi.com/bug-bounty/gmx/"
            },
            {
                platform: "Immunefi",
                name: "Olympus",
                maxBounty: "$3,333,333",
                languages: ["Solidity"],
                categories: ["DAO"],
                difficulty: "Advanced",
                url: "https://immunefi.com/bug-bounty/olympus/"
            },
            {
                platform: "Immunefi",
                name: "Alchemix",
                maxBounty: "$300,000",
                languages: ["Solidity"],
                categories: ["DAO", "Synthetic Assets", "Lending"],
                difficulty: "Intermediate",
                url: "https://immunefi.com/bug-bounty/alchemix/"
            },
            {
                platform: "Immunefi",
                name: "Yearn Finance",
                maxBounty: "$200,000",
                languages: ["Solidity"],
                categories: ["Lending", "Yield Aggregator"],
                difficulty: "Intermediate",
                url: "https://immunefi.com/bug-bounty/yearn/"
            },
            {
                platform: "Immunefi",
                name: "Tranchess",
                maxBounty: "$200,000",
                languages: ["Solidity", "JavaScript"],
                categories: ["Asset Management", "Yield Aggregator"],
                difficulty: "Intermediate",
                url: "https://immunefi.com/bug-bounty/tranchess/"
            },
            {
                platform: "Immunefi",
                name: "monero-oxide",
                maxBounty: "$100,000",
                languages: ["Rust"],
                categories: ["L1"],
                difficulty: "Advanced",
                url: "https://immunefi.com/bug-bounty/monero-oxide/"
            },
            {
                platform: "Immunefi",
                name: "Serai",
                maxBounty: "$30,000",
                languages: ["Rust"],
                categories: ["AMM", "DEX", "L1", "Bridge"],
                difficulty: "Advanced",
                url: "https://immunefi.com/bug-bounty/serai/"
            },
            {
                platform: "Immunefi",
                name: "Hedera",
                maxBounty: "$30,000",
                languages: ["Solidity"],
                categories: ["L1"],
                difficulty: "Beginner",
                url: "https://immunefi.com/bug-bounty/hedera/"
            },
            {
                platform: "Immunefi",
                name: "OpenZeppelin",
                maxBounty: "$25,000",
                languages: ["Solidity"],
                categories: ["L1"],
                difficulty: "Intermediate",
                url: "https://immunefi.com/bug-bounty/openzeppelin/"
            },
            {
                platform: "Immunefi",
                name: "Enzyme Finance",
                maxBounty: "$200,000",
                languages: ["Solidity"],
                categories: ["Asset Management"],
                difficulty: "Intermediate",
                url: "https://immunefi.com/bug-bounty/enzyme/"
            },
            // Cantina Programs - CORRECTED LINKS
            {
                platform: "Cantina",
                name: "Uniswap",
                maxBounty: "$15,500,000",
                languages: ["Solidity"],
                categories: ["DEX", "AMM"],
                difficulty: "Advanced",
                url: "https://cantina.xyz/bounties/f9df94db-c7b1-434b-bb06-d1360abdd1be"
            },
            {
                platform: "Cantina",
                name: "Euler",
                maxBounty: "$7,500,000",
                languages: ["Solidity"],
                categories: ["Lending"],
                difficulty: "Advanced",
                url: "https://cantina.xyz/bounties/4d285eee-602e-440a-845e-25e155cec26a"
            },
            {
                platform: "Cantina",
                name: "Coinbase/Base",
                maxBounty: "$5,000,000",
                languages: ["Solidity"],
                categories: ["L2", "Bridge"],
                difficulty: "Advanced",
                url: "https://cantina.xyz/bounties/55316f42-3c5e-4746-9bd0-0f18dcbc344b"
            },
            {
                platform: "Cantina",
                name: "Morpho",
                maxBounty: "$2,500,000",
                languages: ["Solidity"],
                categories: ["Lending"],
                difficulty: "Advanced",
                url: "https://cantina.xyz/bounties/35a5f0a1-2ffd-432c-8f3b-77d169add8c3"
            },
            {
                platform: "Cantina",
                name: "Pendle",
                maxBounty: "$2,000,000",
                languages: ["Solidity"],
                categories: ["Yield Aggregator"],
                difficulty: "Advanced",
                url: "https://cantina.xyz/bounties/fb1f1c54-0cb9-4201-8791-fb1e78e6e600"
            },
            {
                platform: "Cantina",
                name: "OKX Labs",
                maxBounty: "$1,000,000",
                languages: ["Solidity"],
                categories: ["CEX"],
                difficulty: "Advanced",
                url: "https://cantina.xyz/bounties/00992789-fcd1-4bda-862e-463b0c73faa9"
            },
            {
                platform: "Cantina",
                name: "Monad",
                maxBounty: "$1,000,000",
                languages: ["Rust", "C/C++"],
                categories: ["L1"],
                difficulty: "Advanced",
                url: "https://cantina.xyz/bounties/31f19cea-dda2-4568-8f99-27dafd120c97"
            },
            {
                platform: "Cantina",
                name: "Ventuals",
                maxBounty: "$1,000,000",
                languages: ["Solidity"],
                categories: ["Liquid Staking"],
                difficulty: "Intermediate",
                url: "https://cantina.xyz/bounties/d1c3592e-f335-4235-94ac-c6bf6cdb50a3"
            },
            {
                platform: "Cantina",
                name: "Agglayer/Polygon",
                maxBounty: "$1,000,000",
                languages: ["Rust", "Solidity"],
                categories: ["L2", "Bridge"],
                difficulty: "Advanced",
                url: "https://cantina.xyz/bounties/3aaad22b-52ee-4bb2-bed2-4be53b0993cc"
            },
            {
                platform: "Cantina",
                name: "PancakeSwap",
                maxBounty: "$1,000,000",
                languages: ["Solidity"],
                categories: ["DEX", "AMM"],
                difficulty: "Advanced",
                url: "https://cantina.xyz/bounties/ea552420-8bd6-4119-815d-3d5203d0377a"
            }
        ];

        // Languages and Categories - COMPLETE LIST
        const LANGUAGES = [
            'Solidity', 'Rust', 'Go', 'TypeScript', 'Move', 
            'C/C++', 'JavaScript', 'Python', 'CosmWasm'
        ];

        const CATEGORIES = [
            'AMM', 'Asset Management', 'Bridge', 'CDP', 'CEX', 'DAO', 
            'Derivatives', 'DEX', 'DEX Aggregator', 'Gaming', 'Insurance',
            'L1', 'L2', 'Launchpad', 'Lending', 'Liquid Staking',
            'NFT Marketplace', 'Oracle', 'Perpetuals', 'Stablecoin',
            'Synthetic Assets', 'Wallet', 'Yield Aggregator', 'Zero-Knowledge Proofs'
        ];

        // State
        let currentProfile = null;

        // Navigation
        function showLanding() {
            document.getElementById('landing-page').classList.remove('hidden');
            document.getElementById('profile-connect').classList.add('hidden');
            document.getElementById('loading-state').classList.add('hidden');
            document.getElementById('results-page').classList.add('hidden');
            document.getElementById('manual-skills').classList.add('hidden');
        }

        function showProfileConnect() {
            document.getElementById('landing-page').classList.add('hidden');
            document.getElementById('profile-connect').classList.remove('hidden');
            document.getElementById('loading-state').classList.add('hidden');
            document.getElementById('results-page').classList.add('hidden');
            document.getElementById('manual-skills').classList.add('hidden');
        }

        function showLoading() {
            document.getElementById('landing-page').classList.add('hidden');
            document.getElementById('profile-connect').classList.add('hidden');
            document.getElementById('loading-state').classList.remove('hidden');
            document.getElementById('results-page').classList.add('hidden');
            document.getElementById('manual-skills').classList.add('hidden');
        }

        function showResults() {
            document.getElementById('landing-page').classList.add('hidden');
            document.getElementById('profile-connect').classList.add('hidden');
            document.getElementById('loading-state').classList.add('hidden');
            document.getElementById('results-page').classList.remove('hidden');
            document.getElementById('manual-skills').classList.add('hidden');
            window.scrollTo(0, 0);
        }

        function showManualSkills() {
            document.getElementById('landing-page').classList.add('hidden');
            document.getElementById('profile-connect').classList.add('hidden');
            document.getElementById('loading-state').classList.add('hidden');
            document.getElementById('results-page').classList.add('hidden');
            document.getElementById('manual-skills').classList.remove('hidden');
            initializeManualSkills();
        }

        // Test profiles data (for MVP without backend)
        const TEST_PROFILES = {
            haxatron: {
                immunefi: {
                    earnings: 154408,
                    rank: 130,
                    findings: {
                        bbp: { critical: 0, high: 0, medium: 2, low: 0 },
                        audit_comps: { critical: 1, high: 0, medium: 1, low: 0, insights: 1 }
                    },
                    competitions: [
                        { name: 'VeChain Hayabusa Upgrade', reward: 88174 },
                        { name: 'Puffer Finance', reward: 240 }
                    ]
                },
                cantina: {
                    earnings: 656891,
                    rank: 2,
                    findings: 133,
                    competitions: [
                        { name: 'Omni Network Cross-chain L1 Cosmos SDK Solidity Rust', reward: 230532 },
                        { name: 'Story Protocol L1 Cosmos SDK Solidity', reward: 81021 },
                        { name: 'Optimism Fault Proofs L2 OP Stack Solidity', reward: 92970 },
                        { name: 'Berachain Beacon-Kit L1 Cosmos SDK', reward: 89779 },
                        { name: 'Blast L2 OP Stack Solidity', reward: 49659 },
                        { name: 'Dango DEX CosmWasm Rust AMM', reward: 20415 },
                        { name: 'Ark NFT Bridge Cairo Solidity Bridge', reward: 3153 }
                    ]
                }
            },
            blockian: {
                immunefi: {
                    earnings: 870178,
                    rank: 20,
                    findings: {
                        bbp: { critical: 3, high: 7, medium: 4, low: 7 },
                        audit_comps: { critical: 19, high: 11, medium: 2, low: 5, insights: 13 }
                    },
                    competitions: [
                        { name: 'Shardeum Core III L1 JavaScript', reward: 94767 },
                        { name: 'Fuel Network Rust L1', reward: 70876 },
                        { name: 'Shardeum Ancillaries III', reward: 49315 },
                        { name: 'Movement Labs Move L1', reward: 16675 }
                    ]
                },
                cantina: {
                    earnings: 5465,
                    rank: 323,
                    findings: 1,
                    competitions: [
                        { name: 'Euler v2 Lending Solidity', reward: 5072 }
                    ]
                }
            },
            br0nz3p1ck4x3: {
                immunefi: {
                    earnings: 158030,
                    rank: 94,
                    findings: {
                        bbp: { critical: 2, high: 2, medium: 1, low: 1 },
                        audit_comps: { critical: 2, high: 0, medium: 0, low: 0, insights: 5 }
                    },
                    competitions: [
                        { name: 'Movement Labs Move L1', reward: 13713 },
                        { name: 'Ethereum Protocol L1 Consensus Solidity', reward: 4369 },
                        { name: 'Shardeum Ancillaries III JavaScript', reward: 500 }
                    ]
                },
                cantina: null
            },
            dontonka: {
                immunefi: {
                    earnings: 14138,
                    rank: 421,
                    findings: {
                        bbp: { critical: 0, high: 0, medium: 1, low: 0 },
                        audit_comps: { critical: 1, high: 1, medium: 1, low: 0, insights: 3 }
                    },
                    competitions: [
                        { name: 'ZeroLend Lending Solidity', reward: 5000 },
                        { name: 'DeGate DEX Solidity', reward: 4000 },
                        { name: 'Puffer Finance Staking Solidity', reward: 3000 }
                    ]
                },
                cantina: {
                    earnings: 408490,
                    rank: 5,
                    findings: 77,
                    competitions: [
                        { name: 'Omni Network Cross-chain L1 Cosmos SDK Go Solidity', reward: 124991 },
                        { name: 'Story Protocol L1 Cosmos SDK Go', reward: 45207 },
                        { name: 'Blast L2 OP Stack Solidity', reward: 43405 },
                        { name: 'Ronin Network L1 Go Gaming', reward: 30000 },
                        { name: 'Berachain Beacon-Kit L1 Cosmos SDK Go', reward: 25000 },
                        { name: 'Bitcoin Staking Scripts', reward: 10754 },
                        { name: 'ZetaChain L1 Cosmos SDK Go', reward: 3235 }
                    ]
                }
            }
        };

        // Profile Analysis with TEST DATA (avoids CORS issues)
        async function analyzeProfiles() {
            const immunefiUsername = document.getElementById('immunefiUsername').value.trim().toLowerCase();
            const cantinaUsername = document.getElementById('cantinaUsername').value.trim().toLowerCase();

            if (!immunefiUsername && !cantinaUsername) {
                alert('Please enter at least one username');
                return;
            }

            showLoading();

            // Simulate loading delay
            await new Promise(resolve => setTimeout(resolve, 1500));

            // Check test data
            const profileData = TEST_PROFILES[immunefiUsername] || TEST_PROFILES[cantinaUsername];

            if (!profileData) {
                alert(`Profile not found in demo database. Try one of these usernames:\n\n• haxatron\n• blockian\n• br0nz3p1ck4x3\n• dontonka\n\nNote: Live scraping requires a backend API (CORS restriction). This MVP uses test data.`);
                showProfileConnect();
                return;
            }

            currentProfile = aggregateProfile(profileData);
            displayResults(currentProfile);
            showResults();
        }

        function aggregateProfile(rawProfile) {
            const aggregated = {
                platforms_active: [],
                total_earnings: 0,
                total_findings: 0,
                findings_by_severity: {
                    critical: 0,
                    high: 0,
                    medium: 0,
                    low: 0,
                    insights: 0
                },
                competitions: [],
                skills: {
                    languages: new Set(),
                    categories: new Set(),
                    specializations: new Set()
                }
            };

            // Aggregate Immunefi
            if (rawProfile.immunefi) {
                aggregated.platforms_active.push('Immunefi');
                aggregated.total_earnings += rawProfile.immunefi.earnings;
                
                const immunefiFindings = rawProfile.immunefi.findings;
                aggregated.findings_by_severity.critical += (immunefiFindings.bbp?.critical || 0) + (immunefiFindings.audit_comps?.critical || 0);
                aggregated.findings_by_severity.high += (immunefiFindings.bbp?.high || 0) + (immunefiFindings.audit_comps?.high || 0);
                aggregated.findings_by_severity.medium += (immunefiFindings.bbp?.medium || 0) + (immunefiFindings.audit_comps?.medium || 0);
                aggregated.findings_by_severity.low += (immunefiFindings.bbp?.low || 0) + (immunefiFindings.audit_comps?.low || 0);
                aggregated.findings_by_severity.insights += immunefiFindings.audit_comps?.insights || 0;
                
                aggregated.immunefi_rank = rawProfile.immunefi.rank;
                aggregated.competitions.push(...(rawProfile.immunefi.competitions || []));
            }

            // Aggregate Cantina
            if (rawProfile.cantina) {
                aggregated.platforms_active.push('Cantina');
                aggregated.total_earnings += rawProfile.cantina.earnings;
                aggregated.total_findings += rawProfile.cantina.findings || 0;
                aggregated.cantina_rank = rawProfile.cantina.rank;
                aggregated.competitions.push(...(rawProfile.cantina.competitions || []));
            }

            // Calculate total findings
            aggregated.total_findings += Object.values(aggregated.findings_by_severity).reduce((a, b) => a + b, 0);

            // Detect seniority (EARNINGS FIRST)
            aggregated.seniority = detectSeniority(aggregated);

            // Infer skills from competitions
            aggregated.skills = inferSkills(aggregated.competitions);

            return aggregated;
        }

        function inferSkills(competitions) {
            const skills = {
                languages: new Set(),
                categories: new Set(),
                specializations: new Set()
            };

            for (const comp of competitions) {
                const text = (comp.name || '').toLowerCase();

                // Languages
                if (text.includes('solidity')) skills.languages.add('Solidity');
                if (text.includes('rust')) skills.languages.add('Rust');
                if (text.includes('cairo')) skills.languages.add('Cairo');
                if (text.includes('cosmwasm') || text.includes('cosmos')) skills.languages.add('CosmWasm');
                if (text.includes('move')) skills.languages.add('Move');
                if (text.includes('javascript') || text.includes('typescript')) skills.languages.add('JavaScript');
                if (text.includes('go')) skills.languages.add('Go');
                if (text.includes('c++') || text.includes('cpp')) skills.languages.add('C/C++');

                // Categories
                if (text.includes('dex') || text.includes('amm')) skills.categories.add('DEX');
                if (text.includes('lending')) skills.categories.add('Lending');
                if (text.includes('staking')) skills.categories.add('Staking');
                if (text.includes('dao')) skills.categories.add('DAO');
                if (text.includes('yield')) skills.categories.add('Yield Aggregator');
                if (text.includes('bridge')) skills.categories.add('Bridge');
                if (text.includes('l1') || text.includes('layer 1')) skills.categories.add('L1');
                if (text.includes('l2') || text.includes('layer 2') || text.includes('op stack')) skills.categories.add('L2');
                if (text.includes('nft')) skills.categories.add('NFT Marketplace');
                if (text.includes('perpetual') || text.includes('perp')) skills.categories.add('Perpetuals');
                if (text.includes('liquid staking')) skills.categories.add('Liquid Staking');
            }

            return {
                languages: Array.from(skills.languages),
                categories: Array.from(skills.categories),
                specializations: Array.from(skills.specializations)
            };
        }

        function detectSeniority(profile) {
            const earnings = profile.total_earnings;
            const criticals = profile.findings_by_severity.critical;
            
            // EARNINGS FIRST - Primary signal
            if (earnings >= 50000) {
                return {
                    level: 'ADVANCED',
                    confidence: 99,
                    reasoning: `Total earnings: $${earnings.toLocaleString()}`
                };
            }

            if (earnings >= 5000 && earnings < 50000) {
                return {
                    level: 'INTERMEDIATE',
                    confidence: 95,
                    reasoning: `Total earnings: $${earnings.toLocaleString()}`
                };
            }

            if (criticals >= 3 && earnings >= 20000) {
                return {
                    level: 'ADVANCED',
                    confidence: 90,
                    reasoning: `${criticals} Critical findings + $${earnings.toLocaleString()}`
                };
            }

            // Default to Novice
            return {
                level: 'NOVICE',
                confidence: 80,
                reasoning: `Total earnings: $${earnings.toLocaleString()}`
            };
        }

        // Display results - UPDATED UI
        function displayResults(profile) {
            const summaryHTML = `
                <!-- Seniority Badge and Earnings - CENTERED -->
                <div class="text-center mb-10">
                    <div class="inline-flex items-center gap-3 mb-4">
                        <span class="badge-${profile.seniority.level.toLowerCase()} text-white px-6 py-3 rounded-full text-lg font-bold">
                            ${profile.seniority.level}
                        </span>
                    </div>
                    <div class="mb-2">
                        <div class="text-6xl font-bold gradient-text">$${profile.total_earnings.toLocaleString()}</div>
                        <div class="text-xl text-gray-600 mt-2">Total Earnings</div>
                    </div>
                    <p class="text-gray-600 mt-4">${profile.seniority.reasoning}</p>
                </div>

                <!-- Stats Grid -->
                <div class="grid md:grid-cols-2 gap-6 mb-8">
                    <!-- Platforms -->
                    <div class="bg-gradient-to-br from-purple-50 to-purple-100 p-6 rounded-2xl border-2 border-purple-200">
                        <div class="text-3xl font-bold text-purple-600">${profile.platforms_active.length}</div>
                        <div class="text-gray-700 font-semibold mb-3">Platforms Active</div>
                        <div class="space-y-2">
                            ${profile.platforms_active.map(p => `
                                <div class="flex items-center gap-2">
                                    <svg class="w-5 h-5 text-purple-600" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg>
                                    <span class="font-semibold">${p}</span>
                                    ${p === 'Immunefi' && profile.immunefi_rank ? `<span class="text-sm text-gray-600">(Rank: ${profile.immunefi_rank})</span>` : ''}
                                    ${p === 'Cantina' && profile.cantina_rank ? `<span class="text-sm text-gray-600">(Rank: ${profile.cantina_rank})</span>` : ''}
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- Findings Summary Table -->
                    <div class="bg-gradient-to-br from-sky-50 to-sky-100 p-6 rounded-2xl border-2 border-sky-200">
                        <div class="text-3xl font-bold text-sky-600 mb-3">${profile.total_findings}</div>
                        <div class="text-gray-700 font-semibold mb-4">Total Findings</div>
                        <div class="space-y-2">
                            ${profile.findings_by_severity.critical > 0 ? `
                                <div class="flex justify-between items-center bg-red-100 px-3 py-2 rounded-lg">
                                    <span class="font-semibold text-red-700">Critical</span>
                                    <span class="font-bold text-red-700">${profile.findings_by_severity.critical}</span>
                                </div>
                            ` : ''}
                            ${profile.findings_by_severity.high > 0 ? `
                                <div class="flex justify-between items-center bg-orange-100 px-3 py-2 rounded-lg">
                                    <span class="font-semibold text-orange-700">High</span>
                                    <span class="font-bold text-orange-700">${profile.findings_by_severity.high}</span>
                                </div>
                            ` : ''}
                            ${profile.findings_by_severity.medium > 0 ? `
                                <div class="flex justify-between items-center bg-yellow-100 px-3 py-2 rounded-lg">
                                    <span class="font-semibold text-yellow-700">Medium</span>
                                    <span class="font-bold text-yellow-700">${profile.findings_by_severity.medium}</span>
                                </div>
                            ` : ''}
                            ${profile.findings_by_severity.low > 0 ? `
                                <div class="flex justify-between items-center bg-gray-100 px-3 py-2 rounded-lg">
                                    <span class="font-semibold text-gray-700">Low</span>
                                    <span class="font-bold text-gray-700">${profile.findings_by_severity.low}</span>
                                </div>
                            ` : ''}
                            ${profile.findings_by_severity.insights > 0 ? `
                                <div class="flex justify-between items-center bg-blue-100 px-3 py-2 rounded-lg">
                                    <span class="font-semibold text-blue-700">Insights</span>
                                    <span class="font-bold text-blue-700">${profile.findings_by_severity.insights}</span>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                </div>

                <!-- Editable Skills Section -->
                <div class="bg-gradient-to-br from-indigo-50 to-indigo-100 p-6 rounded-2xl border-2 border-indigo-200 mb-6">
                    <div class="flex justify-between items-center mb-4">
                        <h4 class="font-bold text-lg text-gray-800">Your Tech Stack & Expertise</h4>
                        <button onclick="editSkills()" class="text-sm bg-white hover:bg-gray-50 text-indigo-600 font-semibold px-4 py-2 rounded-lg border-2 border-indigo-300 transition-all">
                            ✏️ Edit Skills
                        </button>
                    </div>
                    <div id="skills-display">
                        ${profile.skills.languages.length > 0 ? `
                            <div class="mb-4">
                                <div class="text-sm text-gray-600 mb-2">LANGUAGES:</div>
                                <div class="flex flex-wrap gap-2">
                                    ${profile.skills.languages.map(lang => `
                                        <span class="bg-white px-3 py-1 rounded-full text-sm font-semibold text-gray-700 border border-indigo-300">${lang}</span>
                                    `).join('')}
                                </div>
                            </div>
                        ` : '<p class="text-gray-600 text-sm">Click "Edit Skills" to add your languages and expertise areas</p>'}
                        ${profile.skills.categories.length > 0 || profile.skills.specializations.length > 0 ? `
                            <div>
                                <div class="text-sm text-gray-600 mb-2">EXPERTISE:</div>
                                <div class="flex flex-wrap gap-2">
                                    ${[...profile.skills.categories, ...profile.skills.specializations].map(cat => `
                                        <span class="bg-white px-3 py-1 rounded-full text-sm font-semibold text-gray-700 border border-indigo-300">${cat}</span>
                                    `).join('')}
                                </div>
                            </div>
                        ` : ''}
                    </div>
                </div>
            `;
            document.getElementById('profile-summary').innerHTML = summaryHTML;

            // Generate recommendations
            const recommendations = generateRecommendations(profile);
            displayRecommendations(recommendations);
        }

        // Edit skills modal/inline
        function editSkills() {
            const modal = `
                <div class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4" onclick="if(event.target===this) closeSkillsModal()">
                    <div class="bg-white rounded-3xl shadow-2xl p-8 max-w-4xl w-full max-h-[90vh] overflow-y-auto" onclick="event.stopPropagation()">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-2xl font-bold gradient-text">Edit Your Skills</h3>
                            <button onclick="closeSkillsModal()" class="text-gray-500 hover:text-gray-700">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                        
                        <div class="mb-6">
                            <h4 class="font-bold text-lg mb-3">Language Proficiency</h4>
                            <p class="text-sm text-gray-600 mb-4">Rate your confidence: 1 = Novice, 5 = Expert</p>
                            <div class="space-y-4" id="modal-languages">
                                ${LANGUAGES.map(lang => {
                                    const currentLevel = currentProfile.skills.languages.includes(lang) ? 3 : 0;
                                    return `
                                        <div class="bg-gray-50 p-4 rounded-xl">
                                            <div class="flex justify-between items-center mb-2">
                                                <span class="font-semibold text-gray-800">${lang}</span>
                                                <span class="text-sm font-bold text-sky-600" id="modal-lang-${lang.replace(/[^a-zA-Z]/g,'')}-value">${currentLevel}</span>
                                            </div>
                                            <input type="range" min="0" max="5" value="${currentLevel}" class="slider w-full modal-lang-slider" 
                                                   data-lang="${lang}" 
                                                   oninput="document.getElementById('modal-lang-${lang.replace(/[^a-zA-Z]/g,'')}-value').textContent = this.value">
                                            <div class="flex justify-between text-xs text-gray-500 mt-1">
                                                <span>None</span>
                                                <span>Novice</span>
                                                <span>Intermediate</span>
                                                <span>Advanced</span>
                                                <span>Expert</span>
                                            </div>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>

                        <div class="mb-6">
                            <h4 class="font-bold text-lg mb-3">Product Categories</h4>
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-2" id="modal-categories">
                                ${CATEGORIES.map(cat => `
                                    <label class="flex items-center bg-gray-50 p-2 rounded-lg cursor-pointer hover:bg-gray-100">
                                        <input type="checkbox" value="${cat}" class="mr-2 modal-cat" ${currentProfile.skills.categories.includes(cat) || currentProfile.skills.specializations.includes(cat) ? 'checked' : ''}>
                                        <span class="text-sm font-semibold">${cat}</span>
                                    </label>
                                `).join('')}
                            </div>
                        </div>

                        <button onclick="saveSkills()" class="w-full bg-gradient-to-r from-sky-500 to-purple-600 hover:from-sky-600 hover:to-purple-700 text-white font-bold px-6 py-3 rounded-xl transition-all">
                            Save Changes
                        </button>
                    </div>
                </div>
            `;
            
            const modalDiv = document.createElement('div');
            modalDiv.id = 'skills-modal';
            modalDiv.innerHTML = modal;
            document.body.appendChild(modalDiv);
        }

        function closeSkillsModal() {
            const modal = document.getElementById('skills-modal');
            if (modal) modal.remove();
        }

        function saveSkills() {
            // Get languages with proficiency >= 1
            const langSliders = document.querySelectorAll('.modal-lang-slider');
            const selectedLangs = Array.from(langSliders)
                .filter(slider => parseInt(slider.value) >= 1)
                .map(slider => slider.dataset.lang);
            
            const selectedCats = Array.from(document.querySelectorAll('.modal-cat:checked')).map(el => el.value);
            
            currentProfile.skills.languages = selectedLangs;
            currentProfile.skills.categories = selectedCats;
            currentProfile.skills.specializations = [];
            
            closeSkillsModal();
            displayResults(currentProfile);
        }

        // Matching algorithm
        function generateRecommendations(profile) {
            const scored = PROGRAMS.map(program => {
                let score = 0;
                let reasons = [];

                // Language match (60 points per match - PRIMARY)
                const langMatches = program.languages.filter(lang => 
                    profile.skills.languages.some(userLang => userLang.includes(lang) || lang.includes(userLang))
                );
                if (langMatches.length > 0) {
                    score += langMatches.length * 60;
                    reasons.push(`Matches your ${langMatches.join(', ')} skills`);
                }

                // Category match (25 points per match)
                const catMatches = program.categories.filter(cat => 
                    profile.skills.categories.includes(cat) || 
                    profile.skills.specializations.some(spec => spec.includes(cat) || cat.includes(spec))
                );
                if (catMatches.length > 0) {
                    score += catMatches.length * 25;
                    reasons.push(`Expertise in ${catMatches.join(', ')}`);
                }

                // Experience level match (30 points bonus, penalties for mismatch)
                const userLevel = profile.seniority.level;
                const programLevel = program.difficulty;
                
                if (userLevel === programLevel) {
                    score += 30;
                    reasons.push(`Perfect experience match (${programLevel})`);
                } else if (userLevel === 'NOVICE' && programLevel === 'Advanced') {
                    score -= 40;
                } else if (userLevel === 'INTERMEDIATE' && programLevel === 'Advanced') {
                    score -= 15;
                } else if (userLevel === 'ADVANCED' && programLevel === 'Beginner') {
                    score -= 10;
                }

                return { ...program, score, matchReasons: reasons };
            });

            // Filter out programs with score < 20 (no meaningful match)
            const filtered = scored.filter(p => p.score >= 20);

            // Sort by score descending
            filtered.sort((a, b) => b.score - a.score);

            return filtered.slice(0, 10); // Top 10
        }

        function displayRecommendations(programs) {
            const html = programs.map((program, index) => `
                <div class="bg-white/90 backdrop-blur-sm rounded-2xl shadow-lg p-6 border-2 ${
                    index === 0 ? 'border-yellow-400' : 
                    index === 1 ? 'border-gray-300' : 
                    index === 2 ? 'border-orange-400' : 
                    'border-sky-200'
                } card-hover">
                    ${index < 3 ? `
                        <div class="inline-block mb-3">
                            <span class="bg-gradient-to-r ${
                                index === 0 ? 'from-yellow-400 to-yellow-600' : 
                                index === 1 ? 'from-gray-400 to-gray-600' : 
                                'from-orange-400 to-orange-600'
                            } text-white px-3 py-1 rounded-full text-xs font-bold">
                                ${index === 0 ? '🥇 BEST MATCH' : index === 1 ? '🥈 GREAT FIT' : '🥉 SOLID CHOICE'}
                            </span>
                        </div>
                    ` : ''}
                    
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h3 class="text-2xl font-bold text-gray-800 mb-1">${program.name}</h3>
                            <span class="inline-block px-3 py-1 rounded-full text-xs font-semibold ${
                                program.platform === 'Immunefi' ? 'bg-sky-100 text-sky-700' : 'bg-purple-100 text-purple-700'
                            }">
                                ${program.platform}
                            </span>
                        </div>
                        <div class="text-right">
                            <div class="text-2xl font-bold text-green-600">${program.maxBounty}</div>
                            <div class="text-xs text-gray-500">Max Bounty</div>
                        </div>
                    </div>

                    ${program.description ? `<p class="text-gray-600 mb-4 text-sm">${program.description}</p>` : ''}

                    <!-- Why this fits you -->
                    ${program.matchReasons && program.matchReasons.length > 0 ? `
                        <div class="mb-4 p-3 bg-green-50 rounded-lg border-2 border-green-200">
                            <div class="text-xs font-bold text-green-700 mb-1">WHY THIS FITS YOU:</div>
                            <div class="text-sm text-green-700">
                                ${program.matchReasons.join(' • ')}
                            </div>
                        </div>
                    ` : ''}

                    <div class="mb-4">
                        <div class="text-xs text-gray-500 mb-2">TECH STACK</div>
                        <div class="flex flex-wrap gap-2">
                            ${program.languages.map(lang => `
                                <span class="bg-indigo-100 text-indigo-700 px-2 py-1 rounded text-xs font-semibold">${lang}</span>
                            `).join('')}
                        </div>
                    </div>

                    <div class="mb-4">
                        <div class="text-xs text-gray-500 mb-2">CATEGORIES</div>
                        <div class="flex flex-wrap gap-2">
                            ${program.categories.map(cat => `
                                <span class="bg-pink-100 text-pink-700 px-2 py-1 rounded text-xs font-semibold">${cat}</span>
                            `).join('')}
                        </div>
                    </div>

                    <div class="flex justify-between items-center pt-4 border-t border-gray-200">
                        <span class="text-sm ${
                            program.difficulty === 'Advanced' ? 'text-red-600' :
                            program.difficulty === 'Intermediate' ? 'text-orange-600' :
                            'text-green-600'
                        } font-semibold">
                            ${program.difficulty}
                        </span>
                        <a href="${program.url}" target="_blank" class="bg-gradient-to-r from-sky-500 to-purple-600 hover:from-sky-600 hover:to-purple-700 text-white font-bold px-6 py-2 rounded-lg text-sm transition-all transform hover:scale-105">
                            View Program →
                        </a>
                    </div>
                </div>
            `).join('');

            document.getElementById('recommendations-grid').innerHTML = html;
        }

        // Manual skills entry
        function initializeManualSkills() {
            // Languages with sliders
            const langHTML = LANGUAGES.map(lang => `
                <div class="bg-white p-4 rounded-xl border-2 border-gray-200">
                    <div class="flex justify-between items-center mb-2">
                        <span class="font-semibold text-gray-800">${lang}</span>
                        <span class="text-sm font-bold text-sky-600" id="lang-${lang.replace(/[^a-zA-Z]/g,'')}-value">3</span>
                    </div>
                    <input type="range" min="1" max="5" value="3" class="slider w-full manual-lang-slider" 
                           data-lang="${lang}" 
                           oninput="document.getElementById('lang-${lang.replace(/[^a-zA-Z]/g,'')}-value').textContent = this.value">
                    <div class="flex justify-between text-xs text-gray-500 mt-1">
                        <span>Novice</span>
                        <span>Expert</span>
                    </div>
                </div>
            `).join('');
            document.getElementById('manual-languages').innerHTML = langHTML;

            // Categories
            const catHTML = CATEGORIES.map(cat => `
                <label class="flex items-center bg-white p-3 rounded-xl border-2 border-gray-300 cursor-pointer hover:border-purple-500 transition-all">
                    <input type="checkbox" value="${cat}" class="mr-2 manual-cat">
                    <span class="font-semibold text-gray-700 text-sm">${cat}</span>
                </label>
            `).join('');
            document.getElementById('manual-categories').innerHTML = catHTML;

            // Experience levels
            const expHTML = `
                <label class="flex items-center space-x-3 cursor-pointer bg-white p-4 rounded-xl border-2 border-gray-300 hover:border-purple-400 transition-all">
                    <input type="radio" name="experience" value="NOVICE" class="text-purple-600">
                    <div>
                        <div class="font-bold text-gray-800">Novice</div>
                        <div class="text-sm text-gray-600">New to bug hunting, learning the basics</div>
                    </div>
                </label>
                <label class="flex items-center space-x-3 cursor-pointer bg-white p-4 rounded-xl border-2 border-gray-300 hover:border-purple-400 transition-all">
                    <input type="radio" name="experience" value="INTERMEDIATE" checked class="text-purple-600">
                    <div>
                        <div class="font-bold text-gray-800">Intermediate</div>
                        <div class="text-sm text-gray-600">Found some bugs, familiar with common vulnerabilities</div>
                    </div>
                </label>
                <label class="flex items-center space-x-3 cursor-pointer bg-white p-4 rounded-xl border-2 border-gray-300 hover:border-purple-400 transition-all">
                    <input type="radio" name="experience" value="ADVANCED" class="text-purple-600">
                    <div>
                        <div class="font-bold text-gray-800">Advanced</div>
                        <div class="text-sm text-gray-600">Experienced researcher with multiple successful reports</div>
                    </div>
                </label>
            `;
            document.getElementById('manual-experience').innerHTML = expHTML;
        }

        function generateManualRecommendations() {
            // Get languages with proficiency >= 3
            const langSliders = document.querySelectorAll('.manual-lang-slider');
            const selectedLangs = Array.from(langSliders)
                .filter(slider => parseInt(slider.value) >= 3)
                .map(slider => slider.dataset.lang);

            const selectedCats = Array.from(document.querySelectorAll('.manual-cat:checked')).map(el => el.value);
            const selectedExp = document.querySelector('input[name="experience"]:checked')?.value || 'INTERMEDIATE';

            if (selectedLangs.length === 0) {
                alert('Please rate at least one language with 3+ proficiency');
                return;
            }

            const manualProfile = {
                seniority: {
                    level: selectedExp,
                    confidence: 80,
                    reasoning: 'Based on self-reported experience level'
                },
                skills: {
                    languages: selectedLangs,
                    categories: selectedCats,
                    specializations: []
                },
                total_earnings: 0,
                total_findings: 0,
                findings_by_severity: { critical: 0, high: 0, medium: 0, low: 0, insights: 0 },
                platforms_active: ['Manual Entry']
            };

            currentProfile = manualProfile;
            displayResults(manualProfile);
            showResults();
        }
    </script>
</body>
</html>
